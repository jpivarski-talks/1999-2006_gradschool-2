<< Graphics`Graphics`;
<< Statistics`ContinuousDistributions`;
<< Graphics`MultipleListPlot`;

isr[x_] = 0;
isr[1] = 8746;
isr[2] = 1855;
isr[3] = 1442;
isr[4] = 1179;
isr[5] = 1001;
isr[6] = 907;
isr[7] = 831;
isr[8] = 729;
isr[9] = 650;
isr[10] = 697;
isr[11] = 661;
isr[12] = 628;
isr[13] = 572;
isr[14] = 535;
isr[15] = 544;
isr[16] = 510;
isr[17] = 515;
isr[18] = 465;
isr[19] = 460;
isr[20] = 431;
isr[21] = 433;
isr[22] = 387;
isr[23] = 394;
isr[24] = 364;
isr[25] = 368;
isr[26] = 358;
isr[27] = 372;
isr[28] = 358;
isr[29] = 331;
isr[30] = 299;
isr[31] = 257;
isr[32] = 319;
isr[33] = 282;
isr[34] = 256;
isr[35] = 300;
isr[36] = 240;
isr[37] = 277;
isr[38] = 252;
isr[39] = 249;
isr[40] = 243;
isr[41] = 222;
isr[42] = 245;
isr[43] = 220;
isr[44] = 218;
isr[45] = 215;
isr[46] = 186;
isr[47] = 186;
isr[48] = 156;
isr[49] = 185;
isr[50] = 177;
isr[51] = 162;
isr[52] = 183;
isr[53] = 163;
isr[54] = 163;
isr[55] = 141;
isr[56] = 170;
isr[57] = 172;
isr[58] = 149;
isr[59] = 142;
isr[60] = 141;
isr[61] = 135;
isr[62] = 136;
isr[63] = 127;
isr[64] = 125;
isr[65] = 128;
isr[66] = 141;
isr[67] = 116;
isr[68] = 121;
isr[69] = 101;
isr[70] = 124;
isr[71] = 97;
isr[72] = 102;
isr[73] = 112;
isr[74] = 111;
isr[75] = 104;
isr[76] = 77;
isr[77] = 98;
isr[78] = 87;
isr[79] = 103;
isr[80] = 81;
isr[81] = 108;
isr[82] = 91;
isr[83] = 94;
isr[84] = 91;
isr[85] = 66;
isr[86] = 68;
isr[87] = 61;
isr[88] = 69;
isr[89] = 63;
isr[90] = 68;
isr[91] = 64;
isr[92] = 62;
isr[93] = 68;
isr[94] = 55;
isr[95] = 61;
isr[96] = 51;
isr[97] = 65;
isr[98] = 59;
isr[99] = 46;
isr[100] = 38;
isr[101] = 60;
isr[102] = 44;
isr[103] = 52;
isr[104] = 56;
isr[105] = 42;
isr[106] = 37;
isr[107] = 44;
isr[108] = 54;
isr[109] = 37;
isr[110] = 42;
isr[111] = 42;
isr[112] = 28;
isr[113] = 36;
isr[114] = 37;
isr[115] = 44;
isr[116] = 23;
isr[117] = 26;
isr[118] = 28;
isr[119] = 30;
isr[120] = 30;
isr[121] = 25;
isr[122] = 26;
isr[123] = 30;
isr[124] = 23;
isr[125] = 21;
isr[126] = 17;
isr[127] = 15;
isr[128] = 28;
isr[129] = 18;
isr[130] = 24;
isr[131] = 25;
isr[132] = 21;
isr[133] = 18;
isr[134] = 25;
isr[135] = 26;
isr[136] = 17;
isr[137] = 19;
isr[138] = 16;
isr[139] = 17;
isr[140] = 19;
fakeisr =
    Compile[{}, (If[Random[] < 0.196323, 1,
		    (x = Random[Integer, {2, 140}];
		     y = Random[Integer, 930];
		     While[y > isr[x],
			   (x = Random[Integer, {2, 140}];
			    y = Random[Integer, 930];)];
		     x)] - 0.5) *
	    If[Random[Integer, {0, 1}] == 1, 1, -1]
	   ];
andreasuncompiled[zeta_, mc_, mlsp_, mw_] =
 (mw * Sqrt[(mc^2-mlsp^2)^2 - 2*mw^2*(mc^2+mlsp^2) + mw^4] / (mw^2-80.425^2)^2) *
 ((mlsp^4 + mc^4 + mw^2*mc^2 - 2*mw^4 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc);
andreas =
 Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}, {mw, _Real}},
	 (mw * Sqrt[(mc^2-mlsp^2)^2 - 2*mw^2*(mc^2+mlsp^2) + mw^4] / (mw^2-80.425^2)^2) *
	 ((mlsp^4 + mc^4 + mw^2*mc^2 - 2*mw^4 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc)
	 ];
topofandreas[zeta_, mc_, mlsp_] :=
    Max[andreas[zeta, mc, mlsp, #]& /@ Range[0, Floor[mc - mlsp], 1]] * 1.05;
randomandreas =
 Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}, {top, _Real}},
	 (x = Random[Real, {0., (mc - mlsp)}];
	 y = Random[Real, {0., top}];
	 While[y > andreas[zeta, mc, mlsp, x],
		 (x = Random[Real, {0., (mc - mlsp)}];
		 y = Random[Real, {0., top}])];
	 x)];
randomdirection =
 Compile[{},
	 (costheta = Random[Real, {-1., 1.}];
	 sintheta = If[costheta > 0., 1., -1.] * Sqrt[1. - costheta^2];
	 phi = Random[Real, {0., 2.*Pi}];
	 {sintheta*Cos[phi], sintheta*Sin[phi], costheta}
	 )];
randomdirectioncor =
    Compile[{{cor, _Real}},
	    (costheta = Random[Real, {-1., 1.}];
	     y = Random[Real, {0., 1+If[cor > 0, cor, 0]}];
	     While[y > 1 + cor*costheta^2,
		   (costheta = Random[Real, {-1., 1.}];
		    y = Random[Real, {0., 1+If[cor > 0, cor, 0]}];)];
	     sintheta = If[costheta > 0., 1., -1.] * Sqrt[1. - costheta^2];
	     phi = Random[Real, {0., 2.*Pi}];
	     {sintheta*Cos[phi], sintheta*Sin[phi], costheta}
	    )];
randomtwobody =
 Compile[{{parent, _Real, 1}, {m1, _Real}, {m2, _Real}},
	 (m0 = Sqrt[parent[[1]]^2 - parent[[2]]^2 - parent[[3]]^2 - parent[[4]]^2];
	 pmag = Sqrt[m0^4 - 2*m0^2*m1^2 + m1^4 - 2*m0^2*m2^2 - 2*m1^2*m2^2 + m2^4]/2/m0;
	 p1 = pmag*randomdirection[];
	 p1 = {Sqrt[pmag^2 + m1^2], p1[[1]], p1[[2]], p1[[3]]};
	 bx = parent[[2]]/parent[[1]];
	 by = parent[[3]]/parent[[1]];
	 bz = parent[[4]]/parent[[1]];
	 gam = 1/Sqrt[1 - bx^2 - by^2 - bz^2];
	 g2 = gam^2/(1+gam);
	 boost = {{gam, gam*bx, gam*by, gam*bz},
		 {gam*bx, 1+g2*bx^2, g2*bx*by, g2*bx*bz},
		 {gam*by, g2*bx*by, 1+g2*by^2, g2*by*bz},
		 {gam*bz, g2*bx*bz, g2*by*bz, 1+g2*bz^2}};
	 boost . p1
	 ), {{boost, _Real, 2}, {p1, _Real, 1}, {p2, _Real, 1}}];
randomtwobodycor =
 Compile[{{parent, _Real, 1}, {m1, _Real}, {m2, _Real}, {cor, _Real}},
	 (m0 = Sqrt[parent[[1]]^2 - parent[[2]]^2 - parent[[3]]^2 - parent[[4]]^2];
	 pmag = Sqrt[m0^4 - 2*m0^2*m1^2 + m1^4 - 2*m0^2*m2^2 - 2*m1^2*m2^2 + m2^4]/2/m0;
	 p1 = pmag*randomdirectioncor[cor];
	 p1 = {Sqrt[pmag^2 + m1^2], p1[[1]], p1[[2]], p1[[3]]};
	 bx = parent[[2]]/parent[[1]];
	 by = parent[[3]]/parent[[1]];
	 bz = parent[[4]]/parent[[1]];
	 gam = 1/Sqrt[1 - bx^2 - by^2 - bz^2];
	 g2 = gam^2/(1+gam);
	 boost = {{gam, gam*bx, gam*by, gam*bz},
		 {gam*bx, 1+g2*bx^2, g2*bx*by, g2*bx*bz},
		 {gam*by, g2*bx*by, 1+g2*by^2, g2*by*bz},
		 {gam*bz, g2*bx*bz, g2*by*bz, 1+g2*bz^2}};
	 boost . p1
	 ), {{boost, _Real, 2}, {p1, _Real, 1}, {p2, _Real, 1}}];
randomnormal[width_] := Random[NormalDistribution[0, width]];
fillhisto[m_, e_] := histo[[Floor[m/2]+1, Floor[e/4]+1]]++;
randomevent =
    Compile[{zeta, chmass, lspmass, top},
	    (failed = False;
	     theisr = fakeisr[];
	     vphoz = {500 - Abs[theisr], 0, 0, theisr};
	     ch1p = randomtwobodycor[vphoz, chmass, chmass, 0.38]; (* +- 0.01 *)
	     ch1m = vphoz - ch1p;
	     wpmass = randomandreas[zeta, chmass, lspmass, top];
	     mrecon = wpmass + randomnormal[8.371/2.];
	     If[mrecon < 0  ||  mrecon > 70, failed = True];
	     If[!failed, (wp = randomtwobody[ch1p, wpmass, lspmass];
			  erecon = wp[[1]] + randomnormal[6.022/2.];
			  If[erecon < 0  ||  erecon > 140, failed = True])];
(* These refinements are small and probably won't change the statistical error (which is all I'm getting here). *)
(* 	     If[!failed, (j1 = randomtwobody[wp, 0, 0]; *)
(* 			  If[Abs[j1[[4]]]/Sqrt[j1[[2]]^2+j1[[3]]^2+j1[[4]]^2] > 0.95, failed = True])]; *)
(* 	     If[!failed, ( *)
(* 		 j2 = wp - j1; *)
(* 		 If[Abs[j2[[4]]]/Sqrt[j2[[2]]^2+j2[[3]]^2+j2[[4]]^2] > 0.95, failed = True] *)
(* 			 )]; *)
(* 	     If[!failed, ( *)
(* 		 wmmass = randomandreas[zeta, chmass, lspmass, top]; *)
(* 		 wm = randomtwobody[ch1m, wmmass, lspmass]; *)
(* 		 ell = randomtwobody[wm, 0, 0]; *)
(* 		 If[ell[[1]] < 10.  ||  Abs[ell[[4]]]/Sqrt[ell[[2]]^2+ell[[3]]^2+ell[[4]]^2] > 0.95, failed = True] *)
(* 			 )]; *)
(* 	     If[!failed, ( *)
(* 		 jsum = j1 + j2; *)
(* 		 If[Sqrt[jsum[[2]]^2+jsum[[3]]^2] < 25, failed = True] *)
(* 			 )]; *)
 	     If[!failed, fillhisto[mrecon, erecon]];
 	     If[!failed, 1, 0]
	    )];
(* rands = Table[Random[NormalDistribution[0,1]], {35}, {35}]; *)
rands = 
{{0.6052779218754147, 0.23616859853726035, -0.8706299752022698, 
  0.2585311842753686, 1.2066169143054455, -0.07665378599747312, 
  0.2873622063538706, 0.5758644225663443, 0.3321901368901736, 
  0.04356739863521178, -1.8306708960032472, -0.06352190555287199, 
  -1.4492459427918774, -0.7899042690886817, 0.5314042541310036, 
  -0.2876647762911394, -0.025484653522385374, -0.8085494863502374, 
  0.143037616680653, -0.39250614835181197, -1.289444955736886, 
  -0.08786263856137791, 1.7616807774869232, 1.2112817120659805, 
  -0.571432170577578, -0.14639299798113373, -1.6102602109629438, 
  -0.8949845606795898, 1.1534950915257602, 0.013921738610985952, 
  0.7319870836976168, -0.0840162658577828, -1.5932633399064757, 
  3.487493164298919, -2.406424677174568}, {1.1017266879516094, 
  1.7269837427910837, -0.39132120617757166, -0.8954177015420127, 
  1.8068174408438615, -0.5631641885409, 0.587467033080552, 
  -0.717090629893616, 1.1542866280600472, 0.026671216285172352, 
  1.1630930905969168, -0.01805664636416703, 0.550004422729868, 
  -0.18919080331296304, -1.1694743471358238, 1.0951719583007908, 
  -0.8857028520739679, -0.84264848238837, -0.6506815178379366, 
  0.3307253811698147, -1.0829472774530446, -1.066798517774405, 
  -0.8923114972318948, 0.41248859630181856, 0.036179165553358074, 
  0.3547597416534163, 0.15767426771512172, 1.2911167244065413, 
  -0.5134053783999103, -0.7552308196384107, 2.3182472980302125, 
  0.4200379177598093, -0.6591306617777124, 0.12463867741632541, 
  -0.4670151417202165}, {-1.887474961124795, 1.3766374368754988, 
  -0.6472549156473181, 0.42636938905460076, 0.012890703370693096, 
  -0.7026655448028665, -1.0751650243053594, -1.02214739201828, 
  0.32018844596026563, 0.6648811129063523, -1.022766999455932, 
  -0.9117510498216056, 0.11929731983459248, -0.28919376448399664, 
  0.2564394689608145, -0.7261982249733788, -0.728136266082464, 
  -0.27751684248874603, 2.3477953358588266, 0.5902042401021351, 
  1.1848344208975619, 0.24284642133330894, -0.3636955116774223, 
  -0.8790936311136908, -0.017795464802484024, 0.6369203201338196, 
  -0.2547726474066651, -2.047373239417162, -0.600557069137222, 
  0.05331166484394995, -0.7630915659730841, -0.773317294283216, 
  -1.2290460359479882, -1.4762243779923634, 1.129075997776142}, 
 {0.8926177174610663, -0.16522259895725683, 0.24909518436479652, 
  -0.3991775272989449, -0.4576051092890379, 0.1544890073398798, 
  0.3486924685936315, 0.5748322634132472, 0.5209810363712872, 
  -0.7542516288117477, -1.0998765776948327, -0.20842521367602007, 
  -0.8640113690617076, 0.42513980701853155, -0.7979081598999163, 
  -2.1270767036966793, 0.15709546329060609, 0.3280995574055819, 
  2.195762520545992, -0.7126575915890749, 0.307022633040504, 
  2.3555643517478555, 0.8998523410425694, -0.2590941186401358, 
  -0.8139628881092451, -0.24580908485874559, 0.1314577533003708, 
  -0.48649604868901336, -1.0618446088156108, 0.5164013347412143, 
  -2.0544283962132948, 0.6485785775100673, -1.0511217134848991, 
  0.6840830572913004, -1.4974787284084707}, {0.20777536908997593, 
  0.6270513617258994, -1.0247419341204773, -0.2223635759739334, 
  0.2418262550558431, -0.8955655607717322, 1.4164586544146698, 
  1.1976325767408036, 0.4888086117305757, -0.1560231413602898, 
  -0.08685794759510158, 0.7393488603553967, 0.7309319012268233, 
  0.8324153267620835, -0.058863017375357846, -0.9553062460768141, 
  -1.1715440382305298, 1.8528315250629066, -0.07619359181430542, 
  0.8966105204346837, -0.2209379602861301, -0.706941259699763, 
  -0.8527598759214658, -0.403016869652882, 0.36067651987228955, 
  -0.7294772574988003, -0.25887831150198154, 2.136679803065799, 
  0.21368855594250025, 0.1960643052771002, 1.7966281252797514, 
  0.7174347326167153, -1.8213138407539864, 0.1765985124223101, 
  0.8040448835603419}, {-0.47666722922282145, 0.4985025937776674, 
  0.5020274107674139, -0.5316571422210826, -0.13026235970166497, 
  -0.6426443621524308, -1.770033010823607, -0.7926595012552635, 
  -0.8047422708236012, 1.1099630507017877, -1.2101981784760734, 
  0.45775155411850654, -0.5725564917794881, 1.5582931255567427, 
  -1.9443523856437905, -0.21075953153121177, 0.3001293966596166, 
  0.3213497623315323, 1.290954383401484, -0.15967748638790016, 
  -0.5209789217915051, -0.014544091217500896, 1.4010705989226908, 
  0.47908311440389284, -0.542916039034183, 0.011145601706522783, 
  0.05758264994776819, 0.5168800075215183, -0.4968814177491134, 
  1.0755381101561585, -0.08742065154812625, 1.5643823546289974, 
  -1.281982075058462, -0.5444937047677044, -0.23021283996181593}, 
 {-2.253326740863471, 0.39640552279420765, 0.13634906842614872, 
  -0.26335794081546166, -0.022750906515370116, -0.003933328099403282, 
  0.7412958072257771, 1.6428798384672614, 0.33554763551555117, 
  -0.35417878227498306, -0.5573137082108408, 0.1781438669247817, 
  0.6336441901149903, 2.0543515235241037, 1.434641464929961, 
  -0.5391646790959351, -1.296428339067267, 1.549775482670089, 
  -0.9987858410269045, 2.740800465656684, -0.6748404390658896, 
  -1.4121381022918116, -0.07970258198183075, 0.5205178356034396, 
  -0.6486363214097591, 1.0162834276843362, 0.3929513200118531, 
  -0.7422104000901748, 0.665154870428975, -1.177955944194679, 
  -0.4021413588950061, -1.0690272620668344, -0.9719517898771373, 
  0.2721933876476155, -1.0918568909784547}, 
 {1.7337730899312829, 0.8516633341016805, 0.8326652595753729, 
  0.5733466517045853, -0.6562491102288946, 2.0487392047221755, 
  0.10366694446960728, -0.37058735269413295, 0.2457369074868007, 
  1.7722531358996714, 2.105724866362206, -0.04630746473693003, 
  0.4847774789357338, -0.3180264479711285, 0.44815715750458013, 
  0.2362675485731717, 0.750907522359112, 0.4980921245337241, 
  1.4822562123862106, 0.3390162372344117, 0.2092775473544871, 
  1.3204660593667052, 0.2892960332893408, -1.4655794106923887, 
  0.25731451189521953, -0.10441127177065734, -1.0181434666312124, 
  0.4626229252104602, 0.26219683015821943, 1.2388231977364417, 
  0.39816335043643586, -0.2764287422133642, 0.8275318867569141, 
  -0.7356500657006765, 0.08332196957588738}, 
 {0.8427500854011254, -1.3642289396479532, -0.9131705113542254, 
  -0.05933515444138564, -0.6017561702199011, 1.4503509799185115, 
  0.3132557502861847, 1.028504839387142, 0.7211559358716985, 
  0.5620882998014111, -0.5131174165993327, 0.36537501900014235, 
  -1.776127091160925, -0.785323776074269, 0.8121394631361233, 
  0.2094334503161205, -2.536272328566887, 0.8232251578527817, 
  -0.5469456664734068, 1.422725343997919, -2.189068459838713, 
  0.6045159253496796, 1.1239781538609945, 1.2479210902799631, 
  -1.336444770017177, -0.8268995369512553, -0.1297822101068443, 
  -0.2322787852757255, 0.5208569941508573, -0.2694234279594337, 
  0.2523996873685235, 1.176953938629048, -0.4018140533018041, 
  0.48539683034082093, 0.09071951376484476}, 
 {1.0087101782707666, -1.178270426170118, -0.4002135708221482, 
  0.44521773244809176, 0.5471853580170462, -0.5199846298700311, 
  -0.18174386173785595, 0.8126604723093048, -1.1433175216463267, 
  -0.9473812610445798, -0.7930606332749692, -0.21605541492624886, 
  -0.44355705687183455, -0.3019414183040522, -1.0562244133119445, 
  0.7170856683847769, -0.8843199413980011, 0.678971884116551, 
  -0.3333316427986549, 0.09715300797347647, 1.1858082988849916, 
  -0.09777023067230962, -0.5284169685963132, -1.2167016972873386, 
  -0.05922059737065118, 0.3057460133177174, -0.8289780126051125, 
  1.0194452036250563, 2.7625623604747163, 0.4095258472240365, 
  -1.0514164334867053, -0.4809884045813839, -0.09565667905169725, 
  0.16491368278915808, 0.1869371509574181}, {-1.1162494184513687, 
  1.784284500302079, -0.21934508890149942, -0.21466776384224892, 
  -0.811153145721521, -0.19407687918921326, 0.017552252227988136, 
  -0.8561530703072316, 0.570921897240408, 0.6602893674446936, 
  0.37407661261788266, -0.1442729183803923, -0.6722101006385827, 
  0.22987932134535105, 1.3644332250457512, -2.72312985239387, 
  -1.2998065389257885, 0.24420267643375107, -0.7459759552713554, 
  -0.3499997859817481, -0.5535437480081588, -0.5918158292864838, 
  -1.6967983998493004, 1.3677020337968833, -0.305495373601907, 
  0.3116094283198221, -0.6563300418398784, -0.35101782851124086, 
  -0.7541640276148618, -1.5259318856227884, -0.12833009603493734, 
  0.948672576385684, 0.1607849608544957, 0.8710815956467499, 
  0.4942118875055364}, {0.2535292008769007, 0.1258631965624333, 
  2.214830936420065, -0.9730968653331449, -0.535136596527916, 
  0.7369570820839079, 1.2427337601601964, -0.6878603951344545, 
  0.7736977869136172, 0.6128160407388816, 0.3979341154380413, 
  -1.037902137599965, -0.5174326059710553, 0.45668474952377486, 
  -0.6282634764418155, -0.20774948327209264, -0.5320118595114723, 
  -1.3882163509849315, -1.8139465274802107, 0.778741904171602, 
  -1.2817630366944766, 0.8066667587634234, -0.298236849359959, 
  -1.5551262713061065, 2.157538318191414, -0.13443488100702405, 
  -1.1858342006709663, -1.2394693324794386, 1.5760744803268754, 
  0.41642256980566555, -0.16993663848590776, 1.4963367795324891, 
  0.3969397317993345, 0.7483990521420666, -0.886164618301301}, 
 {-1.2640898812294452, -1.04919038960366, 0.276781600717136, 
  1.6183586928123728, -1.4268681893097548, 2.2648174156223035, 
  -1.4896219727864999, -0.692090258474384, -2.6118253679274592, 
  0.7797447856095787, -1.5483958194874365, -0.3295328348934659, 
  0.5011201261014887, 1.2660862416667462, -0.028676632988649194, 
  1.8670699699789277, 1.0831390223298176, 2.073261337172043, 
  -0.3813918196436333, -0.022312664242730297, 0.5319997185133439, 
  -1.0189081803638151, -1.0290026244698969, 1.2085810599417686, 
  -0.7355524252634824, 2.078762676412412, 0.9303458496928041, 
  0.38032995251979157, -0.7155582517371742, 0.5735939902541816, 
  1.5636370942943207, 0.17002637038114343, 1.4170709290084107, 
  -1.0882108228092489, -0.6360826212617681}, 
 {-0.18267378083980343, 1.396619082303819, -0.4339479006567235, 
  0.5330587540756236, -0.22311680087776517, -0.3245817213881726, 
  -0.7485522609202597, -0.005694439684314533, -1.5424259690193307, 
  0.22216113504701376, 0.4354641817531184, 0.11366781012310509, 
  -0.2943386902944499, 1.2556712508760979, 0.004490212396660382, 
  0.8950044712975828, 1.5725223211364427, -0.9481779490265957, 
  -0.4112588023063349, -0.5796563875054096, 0.9729163401452914, 
  0.5552569754961958, 0.6830896717819807, -0.35659115932077967, 
  -0.08744085220896601, -1.553889641633993, 0.5052845432840426, 
  -0.7125194101488002, 0.25942282160851526, 1.9695327895867594, 
  -0.2803356085623629, -0.5229590200445015, -1.2428815209593698, 
  -0.9423219424043313, -0.5107016118065187}, 
 {-0.3970783280127301, -0.6885506321614258, 0.8876300212488758, 
  -0.39895197721544584, -0.422308700728463, 0.0826006214754015, 
  -0.6677204870969398, -2.2436523607809122, -0.25231732770383763, 
  0.6916529507213324, 1.2912324288743775, -0.22794069204131415, 
  -0.3613882858670003, 0.8097798370047584, -0.02668316215272619, 
  -0.824427941996451, -1.1531830412368471, -0.4465711308801035, 
  1.3050396849207722, 0.28995837490899523, 0.2978462661277189, 
  0.2943354913431362, 1.0178386657469645, -0.7271598168674611, 
  -0.8498511720897914, -0.4267093925308364, -0.1778216631875776, 
  0.425660032819436, -0.6242946688192469, 0.4569851960641103, 
  -1.29275687635079, 2.1331898962054945, -0.14993368871471047, 
  0.6790812353053481, 0.7071299639681062}, {-0.9591512545272082, 
  -0.20032191176100766, 1.1520886062392002, 2.030925016600548, 
  -0.19511609822737888, -1.1587770780615223, 1.1549594716946534, 
  0.19128464051488528, 0.7255483601504357, 0.7494173443689532, 
  -0.45466507827631036, -0.41930754842688106, 1.436244422642081, 
  0.7335283147910963, 1.9098044029443824, 0.9365340907213558, 
  -1.6238661287927985, -1.5238661256347454, -2.0268410694473356, 
  -0.7598246917128374, 0.5439142226423345, -2.2028156893796726, 
  0.7814598134282956, 0.6337234176091038, 0.27054140594916176, 
  0.4803459551071491, 0.6273477313630238, 1.181406848387892, 
  -0.6423421039875844, -0.5318063464448787, 1.032177211174145, 
  1.0028462108105392, -0.18169316898096763, -1.1729858956285166, 
  1.259316298703248}, {-0.008906926311488858, 1.0631702887117054, 
  1.1379319769374672, 0.5567278899660111, 1.5366164340170576, 
  0.404818138856156, -0.7025647522765142, 0.5876654893497874, 
  -0.34936745036419103, 2.079736815104502, 1.212797526190858, 
  0.21922770280977194, -0.3377858222538051, 1.1919477301643675, 
  -1.6113817573472495, 1.085857560185257, -0.2845239615747945, 
  0.31173828085482513, -0.38100411008978463, -0.20956809675416274, 
  0.8388386136010884, -0.023014748037555675, 2.0275343388777385, 
  1.6496372989000754, 0.3440265695488103, 0.1561021500067179, 
  -1.0410063259963735, 1.2014089419121015, 1.1379589199282354, 
  -0.03848579489247841, -1.163469071385772, -0.06481259719864116, 
  0.24754411436504734, 1.8979012345659863, 0.8762497563030129}, 
 {0.5539558275336511, -0.150989309187307, 0.3956872887960573, 
  1.0089427929995867, 0.5378998553067799, 2.22659646174613, 
  -1.1584995737277897, -0.3073578387931067, 1.0099867817480792, 
  -0.7266771790553431, 1.3170644662028808, 0.07385906336978686, 
  0.991770434478494, 0.191915399080627, 0.36609612808186603, 
  1.2530386625654868, -1.0011621970335345, 1.032682699075847, 
  0.24217605869234765, -1.140409869161489, 1.2278276092541005, 
  0.5995075020701652, 0.35366868088325215, 1.816595863753306, 
  0.7922639573411489, 1.5819355362420862, -0.5116351864232481, 
  0.6416973920804728, -0.4932047686905915, 1.503160866483276, 
  -1.1329723389805773, -0.5686417686080874, -1.500174718466199, 
  0.09475257154625255, -0.5079195771084916}, 
 {0.008929004559335107, 0.16023546050925294, 0.6551273543062516, 
  0.49121195003611323, 0.8756757775619152, 2.199421493470222, 
  1.268988404740763, -0.9517479957558249, -0.599602558886375, 
  0.541296043423946, -0.8011939362350549, 0.10303788946113286, 
  0.6739463544242149, -0.018813801546092176, 0.6451687846615741, 
  0.834940308915128, 1.5129533753745945, 0.46720178648042954, 
  0.08269903088231259, 0.21274541562443208, 0.698575924654127, 
  0.5043591959085405, -0.1829409722925064, 0.3015828747651352, 
  -0.8288888830886675, -0.44120199319745834, -0.45934635930488277, 
  -1.7576998716950185, -0.8372713048843708, -0.8241516505957336, 
  -0.012491840231739671, -1.0734898413262643, -1.5498454944539708, 
  -0.6927185445661048, 1.34048404271178}, {0.2937708858167803, 
  -0.8786468101283272, 0.25295192622364127, 0.7800179726823985, 
  -0.6291160952963504, -1.905369684487295, -0.3093475690906019, 
  -1.1384425669565466, -0.500951565450269, 1.8331435631559325, 
  1.870734692051452, 0.3774680175515071, 0.28431344893835236, 
  -0.5753232319314598, 0.6448066700485285, 0.0891229997312806, 
  -1.081705693904346, -0.7843202873776953, 1.4706028715233328, 
  0.3984087198643109, -1.0159732056035489, 0.46684662741800975, 
  -1.2795841624757103, -0.6147322274388631, 0.10451226531994673, 
  0.4602523362922984, 0.017150015243591978, 0.10938167654429871, 
  0.44856453876585917, 0.5023142508660534, 0.057185303824690815, 
  1.495608336860045, -0.046800413396300325, -0.06817637323551591, 
  0.7491170149324033}, {-0.2984806541951837, -0.324990620372674, 
  -2.286449245911403, -0.6081843620523424, -0.2826461842710677, 
  -1.8729978668357534, -1.824124733149038, 0.6274998563873223, 
  -0.459357038126838, -1.1120376542478647, 0.32154638789703843, 
  -0.29341065039651815, -0.5278501197566555, 2.119837649325888, 
  0.7563173825559643, -1.5920496821327834, -0.015443140171557238, 
  1.4994095387816644, -0.047629060678649464, 0.7873207405195696, 
  0.24141900916471354, -1.8508882585895041, -1.3707680733421013, 
  1.4440483927534657, 1.4147374741228604, 1.8492414469305798, 
  0.8700647538538366, -0.4830971214639938, 0.23561541147996562, 
  -0.908528126857157, 2.8448544190128167, -0.2337116595311727, 
  1.3440661860732712, 0.5273147288037664, -2.5572481305921584}, 
 {1.054514792234539, -0.8882178869307965, 1.263755127809412, 
  -2.7370721171375427, -0.8429833684487382, -0.8316625178524999, 
  0.3977614616009349, -1.280963519079489, -0.2584840575354437, 
  -0.2889651141653828, -0.2685077689832832, 0.4212856909479543, 
  -0.07690057896402902, -0.38075978690249035, -0.6890579827053517, 
  0.05708183556866788, 0.9178781605648523, -1.8956648573611603, 
  0.9068868512363009, 0.6163619627572304, -0.5184289440761721, 
  0.00845495146017922, -0.6364006979101522, 0.9084148030730872, 
  1.7517960779565276, -0.721196294660584, 0.06867394616441569, 
  0.43862782671073824, 1.0071261390584243, -0.6898281774155118, 
  0.5737026608993366, -0.2659374254810355, -0.05322902029678042, 
  -0.24042744222813675, 1.0501375878748267}, 
 {0.02815217501302464, 0.34103980987776594, 1.3161114123050646, 
  1.4924120163455519, 0.7084652502771507, 0.35458266367592217, 
  -0.5196061767581112, 0.47223340888987464, 0.3885247659503176, 
  1.9100113992897179, -1.1937499101598192, 0.6867475481528023, 
  -0.19212802483694247, -0.2650203859711822, -0.8408271335394208, 
  -0.6066291618274953, -2.1839191723054143, 0.5429216385068225, 
  0.46724159633786616, 2.3807836541879808, -0.5402476132415793, 
  0.40755307150597503, 0.6360087479808931, 1.8433475567549291, 
  -1.3306750206599895, -0.3520090253281667, 0.3539090477654869, 
  -0.7528624615545714, -0.5681007405799592, 0.5860786091942423, 
  -1.078066262432499, 0.5409255582075448, 0.8954884058374403, 
  0.7242624658268391, 0.33121374879200866}, 
 {0.5541276935456882, -0.05908282631832997, -1.1387698823211874, 
  -1.9021134473971884, 0.2524634500935127, 1.5699837195575932, 
  1.0479342285491302, -0.3568545037714208, 0.14816091434940165, 
  -1.492035194163401, -0.47836247577950086, -0.3746626777824404, 
  -0.8410193660357933, -0.27466728371621335, 1.71008042548322, 
  0.6171066525166156, 0.017051709754172122, 1.023814367329687, 
  0.28518407337561447, -1.0381593967657705, 1.3877663052948288, 
  1.2394395816620174, -1.0096198215271197, -1.1566409388761723, 
  0.37053779694631417, 0.7311514607729953, 0.38084494614722814, 
  0.18621610357535037, -0.6259328671622006, -0.33709331925601893, 
  -1.8591483776424578, 0.10357972151196077, -0.7505667925842014, 
  -0.5395986173860299, 1.2670454866792054}, {0.05145818808342713, 
  1.29285139222276, 1.156717054286566, 1.3100106243003702, 
  0.9908001991734063, -0.6914748757005236, -1.4172617568006738, 
  0.9771070478055806, 0.8030138890545631, -0.45396463363939615, 
  0.1598765928506134, -0.3770554642516698, 2.9668203639958715, 
  0.25538169757429674, 0.440315952155459, 0.05626063468236809, 
  1.6544834172993985, -0.8496715400827127, -0.8814230382929047, 
  -0.4964451956110414, -0.8951156276539873, 0.19458179054245012, 
  -0.20837811730789996, 1.5819343689182426, -0.5004269663199312, 
  -0.4739453729141523, -2.8373181672987005, -0.8117303289434589, 
  -0.49538075676206605, 0.08013394592403804, -0.15368464489040118, 
  0.7304943773002686, 0.9439453936338539, 0.4514020599775112, 
  -1.1933042734945276}, {0.7329849665186978, 0.24735413581272742, 
  -1.3594743715079898, -0.32860240150542, 1.174713457327698, 
  0.35867365888429625, 0.8293979736528232, 0.6248664103271431, 
  1.0851139061488506, 0.33343911423852596, 0.43910367847782084, 
  -1.0719335364873948, 0.3176167186902183, 0.11355005399795719, 
  0.22425469085716687, -0.306207552565545, 0.9565010133617704, 
  -2.5496404461638305, -0.8869033446902271, -0.19287964108336247, 
  -0.692750433013349, -0.053319664046236566, -1.8437063148259825, 
  -0.218259415339379, -0.08763901592982125, 0.6335810780926833, 
  -1.140897782830332, -0.56915978906769, -1.4061351464623784, 
  0.6186975839166842, 2.472928713563445, -0.3268559977882138, 
  -0.8335939109822028, -0.22236671904773828, 1.5744129666682134}, 
 {-1.0222718613282709, -0.13161934351825377, -0.512838796207238, 
  0.3168587160321755, 0.3812641359963565, -1.3071878676392292, 
  0.11053151385155693, -0.8321833186571485, -2.266221955453476, 
  -0.19170231594117654, 0.16426794307713372, -0.6764802059631324, 
  -0.559783496644999, -0.10124399457250118, 1.9353920482707052, 
  -1.5953635247896396, 0.3633881106911412, 2.521636583338241, 
  -1.065337878851221, 0.008593984802647916, 1.3302715009793329, 
  0.4770213648963133, 0.33278517551698583, -1.8880798710515407, 
  0.601802568321222, 0.3560433109299516, 0.40717282543273264, 
  -0.2855303629983989, -2.4000258722546253, -1.240449409068452, 
  0.44589771684515583, 1.1193788975158416, 0.5787420178207232, 
  0.4623479760213147, 0.4815964279210173}, {-0.7707400449428156, 
  0.8915790255575581, 0.30654761641278994, -0.17234698786502645, 
  -0.6169563379330094, 0.009383314266986782, 0.06180130791278965, 
  -1.264702298900187, 1.1037936291498014, -1.2229251555214504, 
  0.671812295320256, -1.147410680031799, -0.24745376655596316, 
  0.010071870599026703, -0.9395826088220742, 2.393539797403148, 
  0.27449285412011204, 1.398854543008953, -1.682194875127828, 
  -0.7527341393710228, -0.4236117107642567, 0.3661634673537131, 
  -2.027010717000326, 0.7154418472530767, 0.17769406622749792, 
  -1.6110362362301913, 0.6846257663510578, -0.8727853488900915, 
  1.4424509679545006, -2.0307798203200687, -1.5897809675013774, 
  1.2677867941611245, 1.5696245738453793, 0.008045892338528988, 
  -1.9120213612665033}, {0.7104399168364605, -0.04916659258120594, 
  -0.7708626659804875, -1.4142458415838848, -0.43022015416504583, 
  -0.19791997722108967, 0.7629922472373867, 0.6520543386682423, 
  0.10586486228262636, 1.0413918981960255, -0.4834711822129654, 
  -1.1706781065429197, -1.952346208584871, -0.25954292685018554, 
  0.5529632751513588, 0.8319337185588466, -1.5908509103106814, 
  -0.9477187896484112, -0.4668972623147298, -0.5307706757184079, 
  1.6318861379298901, -0.6615082613699, -1.277235807080334, 
  -0.08157697652159916, 1.6990476684207891, -2.0585068525308086, 
  0.7983470412114705, -1.2443684969164301, -1.352766393261186, 
  0.471616088762339, 0.8075956372015805, -1.0319859220824896, 
  1.714734177307277, -0.3758553693969046, -0.7433091462517144}, 
 {-0.27719855294999496, -1.0658351027765123, -0.011703500757908217, 
  -0.2688081510988024, 0.11639686650331567, 0.6518602043801386, 
  -0.2954368362936084, 1.543556013792848, 1.210294537684924, 
  1.2099472048890412, -0.3988713806322066, -0.7121548291434149, 
  0.7744852826276227, 0.3336405167288653, 0.16787862908242726, 
  -0.10821723816546149, 1.3649086510211164, 0.7738210483526716, 
  -0.2762300092864192, 0.9905003068796495, -0.33854297226200075, 
  -0.2565095433938966, -0.632353109853173, 1.3715287437068888, 
  -3.538224958069688, 0.9764477648660808, 0.19520050969725206, 
  0.3368972690612963, -0.05017708643360185, -1.1427968017784127, 
  -0.1949817958673633, -1.747040069383356, 0.6862948584078198, 
  0.9901655102865541, -0.468136691705696}, {0.1313455757744423, 
  0.45895793489985676, 1.1243844529958706, 0.2849612879210246, 
  -0.015988661186975072, -0.399099566394646, -0.5854185218327677, 
  0.3328421128484391, 0.5232460192514875, 1.2766873873772362, 
  1.7700078951332587, -1.011465888813657, 1.3304766189197903, 
  -1.0138517531268534, 0.38412104861148777, 0.04357903198962027, 
  -0.622184701590353, 0.09262459314367237, 2.236147037533991, 
  -0.011292537843655118, 0.2109519469697449, 0.4606312473938729, 
  -0.11648307711576002, -1.64770399115301, 1.2034510833133825, 
  0.9006616205743493, 1.3418966131930474, 0.06144348159536311, 
  -0.9372739770597742, 0.36109392608879487, -1.0946401276603448, 
  0.015031421885100715, -0.5641058855599402, -1.2440090345296808, 
  0.864057476046125}, {1.9832833568657269, 0.7457655864386469, 
  1.2092425265559525, 1.4980297606752657, 0.30663494940932806, 
  -0.5953022345456265, 0.18521553284767786, 0.051636930726598744, 
  0.8121308021677869, -0.22717818121288622, -1.2746145416559411, 
  -1.5439338529812963, -1.381951080715041, -0.41419405846976315, 
  -0.48169810572514976, 0.13553413987876708, -1.7357487610580897, 
  -2.4245707593757273, 0.2689504917165504, -2.1917762475575207, 
  0.05215988186883287, 2.29856627391837, -0.6517227454844295, 
  -0.7159439754300826, 1.7714022168803956, 1.3546334457138722, 
  -1.3644534078579478, 1.1049379462811464, 1.801851559855356, 
  -0.803947023024047, 0.2610752665121417, 1.2679168105000365, 
  -0.2628840155501929, 1.4417575372955032, 0.8118984808438395}, 
 {-1.0458088848461011, 0.502181416717155, -0.5666696142112079, 
  -1.4730132760047057, -1.9573108385018119, -0.2757075703803072, 
  0.9430664629158629, -1.7807945623498915, 1.4758101342200654, 
  1.7431106391280484, 0.44638515970135745, 0.7906535107963827, 
  -1.222173746151421, -0.325905241210253, -0.13910553377135518, 
  1.8050293976628329, 0.6171329516730554, -1.6370862828494461, 
  1.0972758382274028, 2.597330289774437, -0.0627827190714007, 
  0.6235985986511405, -2.1872360613543047, 1.7052977935152658, 
  0.781959302367625, -0.0944914979605797, -0.008836520330717777, 
  -0.01397856198964571, 0.9698469136784601, 0.3610099551583379, 
  1.6136281085727007, 0.4578200858597065, -0.43490339328360045, 
  0.4006729747206332, -0.6151898668094933}, {0.26883756801019765, 
  -0.47711644897691596, -0.8816784231629277, 0.8262746387512901, 
  0.2255294820324185, 1.3350531616901715, -1.577972610169745, 
  2.1745775904671025, -1.168920361204573, -0.09210209671025893, 
  -0.32746063330467917, 1.4588369330917828, 2.5337335122877906, 
  -0.7369263499430878, -1.3556130529281614, -0.16699956799682927, 
  0.034070803583448245, -0.7414910265028373, 0.7905200429900401, 
  -0.6881543148223089, -1.1261959861629258, -0.35815728387935675, 
  -1.0604190679892584, -0.9448381018280362, -0.27569553617731923, 
  0.1619707124423156, -0.533657667696538, -0.07430767430459079, 
  1.2823763656997458, -0.6327515735538816, 0.15442669978210613, 
  0.7442296872397371, 0.21725476221955953, -0.2546743672699325, 
  0.04730198977812882}, {0.07956696109891963, -1.7092469476073058, 
  -1.2612930064847074, 0.022064946153437473, 0.9099322329013951, 
  0.13822482172676387, -2.040930764485276, 0.5560840854369781, 
  -1.1899105805104095, 0.16972294633595247, -0.11586364764402679, 
  1.4252754066912259, -1.7818240163496613, -1.9196923750711496, 
  0.5087644043937859, 0.2343906039405191, 1.1824568567926053, 
  2.172055513128473, -1.4502068769082768, 1.4309052371930244, 
  0.11574452809845047, -0.2788890116311714, -0.7034342059356222, 
  0.4196990664590443, 0.9895892839080862, -0.24083858462410254, 
  0.28469149756669243, 1.1358177534956313, 0.04399941805645708, 
  0.055140829967604194, -0.5589061868234187, -0.2807548622361463, 
  -0.09300768528340689, -1.162470638125181, 1.6494237354572194}};
(* histo = Table[0, {35}, {35}]; *)
(* thetop = topofandreas[0.9, 159.417, 107.697]; *)
(* (\* target number is 15546.6 *\) *)
(* Print[Plus @@ Table[randomevent[0.9, 159.417, 107.697, thetop], {Floor[15546.6/28462*(6614/0.2269)]}]]; *)
(* histo // InputForm *)

ListDensityPlot[vals, DisplayFunction -> (Display["tmp.eps", #, "EPS"]&)];



vals = 
{{0, 0, 0, 0, 1, 2, 4, 3, 2, 4, 6, 4, 2, 0, 6, 2, 4, 5, 5, 2, 5, 8, 3, 4, 5, 
  2, 3, 1, 0, 2, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 2, 4, 1, 10, 6, 7, 5, 5, 9, 7, 
  4, 6, 7, 7, 5, 1, 7, 3, 3, 5, 7, 3, 6, 3, 3, 4, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 2, 3, 6, 10, 8, 15, 10, 5, 8, 7, 10, 9, 5, 11, 7, 6, 7, 5, 10, 5, 
  9, 11, 5, 9, 7, 6, 3, 2, 0, 0, 0, 0}, {0, 0, 0, 1, 4, 6, 14, 4, 12, 10, 14, 
  10, 11, 13, 15, 15, 9, 20, 10, 10, 15, 12, 12, 11, 6, 7, 6, 8, 6, 2, 1, 0, 
  0, 0, 0}, {0, 0, 0, 7, 8, 20, 10, 15, 23, 14, 16, 11, 18, 14, 18, 11, 14, 
  21, 13, 11, 8, 10, 14, 6, 10, 12, 9, 6, 10, 6, 0, 1, 0, 0, 0}, 
 {0, 0, 0, 0, 8, 14, 21, 12, 17, 16, 20, 23, 24, 18, 14, 16, 13, 25, 20, 12, 
  20, 14, 21, 20, 12, 10, 11, 10, 7, 4, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 5, 13, 34, 18, 22, 20, 16, 17, 23, 28, 16, 25, 21, 18, 29, 15, 
  22, 27, 22, 15, 11, 20, 22, 21, 7, 3, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 1, 6, 16, 26, 23, 28, 28, 25, 26, 26, 17, 29, 25, 34, 19, 25, 28, 
  17, 24, 22, 12, 21, 19, 15, 12, 9, 3, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 2, 17, 33, 13, 27, 27, 26, 29, 24, 24, 22, 24, 29, 31, 24, 29, 
  25, 28, 31, 32, 19, 30, 27, 15, 15, 3, 4, 0, 0, 0, 0}, 
 {0, 0, 0, 1, 3, 17, 32, 29, 31, 30, 32, 29, 24, 26, 34, 28, 32, 28, 28, 40, 
  39, 38, 24, 24, 17, 18, 26, 21, 15, 6, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 4, 10, 19, 29, 29, 43, 39, 28, 28, 30, 39, 32, 35, 27, 28, 41, 
  32, 37, 28, 32, 34, 27, 34, 22, 15, 7, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 3, 5, 17, 36, 42, 34, 39, 30, 42, 37, 37, 42, 45, 37, 33, 32, 
  30, 27, 33, 40, 36, 33, 31, 27, 16, 3, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 1, 4, 10, 32, 42, 41, 41, 34, 38, 47, 47, 34, 32, 41, 34, 40, 
  37, 42, 38, 47, 40, 24, 27, 20, 15, 4, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 1, 5, 19, 25, 56, 53, 56, 52, 42, 53, 45, 44, 42, 49, 33, 43, 
  46, 42, 42, 35, 43, 39, 41, 22, 9, 4, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 2, 15, 24, 36, 50, 56, 48, 43, 35, 39, 59, 44, 53, 42, 46, 
  47, 47, 51, 42, 26, 34, 40, 27, 14, 7, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 1, 4, 26, 29, 38, 55, 51, 43, 40, 60, 47, 51, 49, 50, 53, 
  46, 45, 41, 33, 44, 25, 36, 19, 11, 3, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 2, 15, 24, 35, 43, 53, 50, 55, 48, 52, 63, 40, 52, 55, 
  38, 58, 42, 47, 49, 35, 26, 20, 8, 2, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 8, 23, 23, 47, 45, 58, 48, 54, 58, 51, 54, 65, 54, 57, 
  66, 57, 45, 41, 35, 14, 20, 2, 1, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 1, 2, 6, 30, 41, 46, 47, 62, 59, 58, 63, 52, 47, 61, 69, 
  55, 44, 42, 40, 43, 26, 15, 4, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 2, 9, 16, 28, 51, 55, 55, 67, 63, 67, 46, 57, 59, 52, 
  52, 53, 40, 35, 24, 17, 11, 3, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 5, 8, 20, 36, 58, 50, 49, 61, 59, 53, 50, 46, 58, 
  41, 46, 57, 35, 30, 14, 7, 2, 1, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 1, 0, 8, 16, 29, 39, 49, 70, 59, 61, 49, 55, 52, 48, 
  49, 36, 47, 25, 16, 12, 2, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 5, 24, 29, 32, 43, 41, 55, 47, 44, 56, 38, 
  47, 48, 43, 27, 15, 9, 2, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 1, 0, 4, 6, 7, 22, 30, 40, 32, 42, 42, 40, 47, 45, 49, 
  30, 23, 18, 11, 5, 2, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  1, 6, 12, 23, 22, 29, 25, 44, 45, 24, 29, 27, 25, 11, 10, 4, 2, 1, 1, 0, 0, 
  0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 21, 18, 25, 20, 25, 
  16, 22, 19, 8, 16, 4, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 7, 8, 14, 14, 10, 15, 16, 9, 10, 10, 
  5, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
  1, 2, 2, 4, 6, 9, 8, 6, 11, 8, 4, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 2, 2, 0, 5, 0, 3, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 2, 0, 1, 5, 4, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
(* backgrounds = Table[TMP[i,j], {i, 1, 35}, {j, 1, 35}]; *)
(* ListDensityPlot[Transpose[histo]]; *)
(* ListDensityPlot[Transpose[backgrounds]]; *)
backgrounds = 
{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0.173207, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0.247525, 1.30156, 0.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.125, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 21.8362, 25.9236, 1.47477, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 60.537, 1.30777, 1.31556, 0.298207, 0.125, 0.173207, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0}, {0, 0, 0, 1.63887, 0.596415, 24.4902, 24.9831, 
  0.548207, 0, 0.125, 0, 0, 0.125, 19.8628, 0, 0, 0, 0.25, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0.17723, 0, 0, 0, 0}, 
 {0, 0, 0, 0.346415, 44.0266, 0.776195, 2.47753, 0.918852, 1.9577, 
  0.721415, 0.173207, 0.25, 0, 0.17723, 0, 0, 0.940557, 0, 0, 0, 
  0.125, 0, 0, 0.125, 0, 0, 0, 0, 0.125, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 230.626, 48.1986, 68.7625, 4.33637, 27.6822, 25.1396, 
  2.24212, 2.19899, 0.86629, 0.543852, 1.30156, 0, 0.940557, 0, 0, 
  0, 0, 0.125, 0, 0.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0.125, 84.1237, 3.20122, 27.8389, 26.8986, 3.04496, 
  1.65298, 0.548207, 1.83518, 1.60941, 0.298207, 1.3112, 0.125, 0, 
  0.17723, 0.173207, 0.173207, 0.173207, 0.125, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 4.07147, 5.77249, 25.4559, 
  45.1255, 5.69023, 4.68941, 0.942829, 10.0379, 2.95297, 2.09639, 
  4.42538, 0.71706, 0, 0.298207, 2.40878, 0.298207, 0.60446, 
  1.41197, 0.173207, 0, 0.17723, 0, 0.125, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 45.0022, 5.05567, 66.7373, 7.9448, 26.4326, 
  40.5716, 14.967, 2.01785, 7.11407, 4.1993, 4.2008, 1.36129, 
  1.61129, 0.940557, 0.940557, 0.423207, 0.125, 0.940557, 1.88111, 
  0.173207, 0.125, 0, 1.18808, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 5.40065, 6.62407, 138.654, 23.2885, 27.1576, 
  3.1935, 41.8706, 4.64239, 2.99681, 48.8738, 3.79968, 1.92002, 
  1.02681, 1.48441, 2.12864, 4.25608, 1.11376, 0.125, 0.125, 
  1.29099, 0.125, 0, 0.30223, 0.17723, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0.892147, 8.91951, 29.3055, 29.2072, 19.6272, 
  7.32107, 6.45364, 7.30214, 40.729, 16.3716, 4.61852, 1.47554, 
  2.77326, 2.05432, 0.722962, 0.42723, 0.298207, 0.173207, 2.05834, 
  1.29502, 0.940557, 1.88111, 0.17723, 0.125, 0, 0.125, 0, 24.0061, 
  0}, {0, 0, 0, 0, 0, 0, 0, 3.98874, 7.05421, 10.5538, 9.53513, 
  8.8923, 32.3084, 16.5158, 24.4838, 9.40789, 4.14857, 5.22814, 
  8.20308, 0.905836, 3.13524, 2.80432, 2.55432, 0.173207, 2.67839, 
  1.68313, 0, 1.09038, 0.982704, 0.17723, 0.30223, 0, 0.17723, 0, 
  0}, {0, 0, 0, 0, 0, 0, 0, 0.357961, 31.8126, 9.30313, 141.168, 
  14.1805, 10.4054, 15.2788, 8.13211, 35.5578, 7.11313, 12.3749, 
  7.05784, 5.62319, 2.80319, 2.12089, 1.91104, 3.76223, 2.62616, 
  2.55339, 2.38369, 0, 1.46822, 1.24279, 0.30223, 0.173207, 0, 
  0.17723, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 6.47019, 9.50276, 6.87738, 
  8.74087, 28.6296, 9.0961, 9.5679, 9.42027, 11.2783, 8.82308, 
  7.50905, 11.7829, 3.20956, 16.7209, 0.780243, 7.0309, 2.78131, 
  0.84951, 5.7958, 0.125, 0.42723, 0, 0.42723, 0.125, 0.125, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 2.60972, 13.0265, 9.24441, 11.4413, 
  21.2643, 15.6498, 12.756, 12.6427, 9.3951, 8.52069, 3.70676, 
  9.71559, 2.91033, 4.38205, 2.90785, 2.30834, 5.90521, 2.12864, 
  3.3192, 1.25868, 25.2331, 0.17723, 0.35446, 0.35446, 0, 0, 
  0.125}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 2.11828, 8.6508, 15.859, 
  17.4751, 10.7043, 10.0608, 10.745, 16.3798, 10.6889, 8.49133, 
  7.76979, 9.36559, 11.1612, 16.205, 7.92444, 5.80487, 3.24847, 
  1.23876, 0.125, 0.372525, 1.06556, 0.25, 0.17723, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0.531168, 7.0608, 8.1109, 14.4722, 
  14.7044, 13.7137, 16.7416, 39.6785, 14.8619, 14.5811, 26.9765, 
  12.8745, 10.3507, 10.7007, 8.94808, 3.19232, 8.6762, 8.04374, 
  6.46019, 0, 1.28697, 0.17723, 0.30223, 0.298207, 0.17723, 
  0.17723}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4.07425, 7.31447, 
  13.7326, 8.96523, 23.7203, 10.3282, 34.7044, 16.5294, 13.7618, 
  18.7394, 10.7465, 8.93754, 7.51698, 10.9097, 33.9205, 0.372525, 
  3.4442, 0.97451, 0, 0.30223, 0.424755, 0.173207, 0.656691, 0, 
  5.76205}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.14934, 5.97844, 
  14.7451, 15.2953, 12.3921, 36.9924, 21.0606, 16.5072, 14.1239, 
  16.6395, 23.1672, 9.45643, 19.0858, 11.0749, 17.8477, 13.565, 
  1.79254, 0.779216, 17.0542, 0.903693, 0.35446, 0, 0.42723, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.519622, 13.2211, 11.5248, 
  30.4765, 16.8348, 22.0439, 14.954, 13.2142, 13.5626, 43.6805, 
  39.9185, 12.4778, 10.9077, 8.45156, 7.94555, 2.4831, 2.40272, 
  10.9387, 0.25, 1.78102, 0.25, 0.30223, 10.8865, 0.125}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9.24625, 8.50199, 14.5664, 
  19.8058, 14.4786, 7.46391, 57.5386, 12.3044, 47.3718, 4.49932, 
  18.7466, 12.7351, 6.16466, 1.50218, 0.692758, 4.99868, 2.18334, 
  1.205, 0.125, 0.30223, 0, 0.35446, 0.125}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.692829, 20.64, 13.7828, 
  20.2974, 10.6635, 14.2226, 14.5903, 13.4041, 24.1113, 9.33953, 
  6.70249, 5.0659, 7.03154, 4.27162, 1.74166, 1.61159, 0.30223, 
  0.976985, 0.55223, 0.648645, 1.81662, 0, 26.2846}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.00952, 24.4596, 9.08403, 
  15.0467, 10.9777, 9.23163, 35.5436, 8.34262, 8.30477, 25.9014, 
  6.01048, 9.80003, 6.0763, 4.18655, 3.58678, 1.22451, 0.375, 
  0.872525, 0.829898, 11.241, 1.33716, 0.17723, 0.30223}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.561, 5.3932, 8.23606, 
  19.8611, 37.8619, 9.20189, 14.3263, 10.7208, 16.7194, 5.37623, 
  13.8682, 6.13211, 18.0436, 3.67178, 3.50463, 2.21789, 0.825875, 
  0.30223, 17.3856, 0.350437, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 1.84977, 17.9496, 28.5871, 6.15328, 29.1112, 8.07686, 
  10.3169, 13.9713, 17.7121, 10.231, 11.8182, 7.76248, 5.65284, 
  2.28804, 1.70814, 1.27767, 0.781691, 1.54706, 15.7852, 0.652668, 
  0.531691, 0.30223}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  6.63224, 5.42787, 8.60462, 9.55136, 8.25598, 12.7726, 3.03358, 
  9.25991, 29.5456, 9.81711, 8.30027, 19.324, 28.8081, 3.54856, 
  2.67326, 2.01037, 24.6785, 0.902668, 2.6104, 0.17723, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.346415, 45.9968, 
  17.1348, 11.465, 9.54472, 31.9277, 15.4993, 7.00312, 12.7624, 
  7.97359, 4.53152, 12.2069, 26.7627, 21.9, 2.13146, 1.45814, 
  1.18786, 0.350437, 1.55156, 1.98983, 0.47946}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.99362, 13.8536, 
  10.1631, 19.5375, 9.96563, 7.02533, 9.40229, 11.0591, 30.4104, 
  15.5177, 4.73746, 1.3455, 27.811, 26.0108, 11.7266, 3.12202, 
  2.88873, 17.5758, 0.55223, 0.878105}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0.704376, 24.0628, 8.81602, 10.7242, 12.9066, 
  9.95826, 30.4421, 7.57747, 5.682, 32.2859, 24.9504, 5.06834, 
  3.84759, 3.95184, 0.656691, 2.85288, 2.96851, 2.42115, 50.4063, 
  0.346415}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  6.28692, 34.6276, 10.2998, 10.9852, 38.4887, 39.551, 5.26853, 
  9.73071, 31.9762, 3.47868, 6.33787, 8.36942, 2.93344, 2.97535, 
  0.898645, 25.6825, 0.72946, 16.8913, 0.125}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.942829, 
  11.1447, 12.0263, 13.4473, 12.9385, 11.806, 26.4001, 14.5404, 
  6.49961, 28.6455, 9.7493, 6.77532, 3.72205, 53.3547, 1.00713, 
  1.42598, 2.01834, 0.769622, 3.42498}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 5.23662, 15.4348, 15.3046, 21.0517, 
  9.59136, 37.7491, 9.94966, 7.94243, 7.41616, 9.59846, 5.13868, 
  5.36181, 10.4279, 2.75233, 3.9154, 0.846415, 0.696852, 0.72946}};
err2s = vals + backgrounds;
data = N[Table[{vals[[i,j]] + rands[[i,j]]*Sqrt[backgrounds[[i,j]]],
		Sqrt[err2s[[i,j]]]}, {i, 1, 35}, {j, 1, 35}]];
datasum = Sum[data[[i,j,1]], {i, 1, 35}, {j, 1, 35}];
dataerr = Sqrt[Sum[data[[i,j,2]]^2, {i, 1, 35}, {j, 1, 35}]];
chisquare = 
    Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}},
	    histo = Table[0, {35}, {35}];
	    thetop = topofandreas[zeta, mc, mlsp];
	    mcsum = Plus @@ Table[randomevent[zeta, mc, mlsp, thetop], {100000}];
	    histn[zeta, mc, mlsp] = datasum/mcsum*histo;
	    Sum[If[data[[i,j,2]] > 0,
		    (data[[i,j,1]] - datasum/mcsum*histo[[i,j]])^2/(data[[i,j,2]]^2 + (datasum/mcsum)^2*histo[[i,j]]), 0],
		 {i, 1, 35}, {j, 1, 35}],
	   {{data, _Real, 3}, {histo, _Real, 2}}];
ndof = Sum[If[data[[i,j,2]] > 0, 1, 0], {i, 1, 35}, {j, 1, 35}] - 3;

(* histo = Table[0, {35}, {35}]; *)
(* thetop = topofandreas[0.9, 159.417, 107.697]; *)
(* mcsum = Plus @@ Table[randomevent[0.9, 159.417, 107.697, thetop], {1000000}]; *)
(* MultipleListPlot[ *)
(*     {Table[{{i*2, Sum[data[[i,j,1]], {j, 1, 35}]}, ErrorBar[Sqrt[Sum[data[[i,j,2]]^2, {j, 1, 35}]]]}, {i, 1, 35}], *)
(*      Table[{i*2, Sum[datasum/mcsum*histo[[i,j]], {j, 1, 35}]}, {i, 1, 35}]}, *)
(*     PlotJoined -> {False, True}, *)
(*     SymbolShape -> {PlotSymbol[Box, 0.9], PlotSymbol[Box, 0]}, *)
(*     PlotStyle -> {Dashing[{}]}, *)
(*     Frame -> True, *)
(*     Axes -> True, *)
(*     AxesOrigin -> {0, 0}, *)
(*     PlotRange -> {{0, 71}, {-40, 1000}}, *)
(*     FrameLabel -> {"Jet-jet invariant mass (GeV)", None, None, None}, *)
(*     ImageSize -> 72*4 *)
(*     , DisplayFunction -> (Display["fake3_mass.eps", #, "EPS"]&) *)
(* 		]; *)
(* MultipleListPlot[ *)
(*     {Table[{{j*4, Sum[data[[i,j,1]], {i, 1, 35}]}, ErrorBar[Sqrt[Sum[data[[i,j,2]]^2, {i, 1, 35}]]]}, {j, 1, 35}], *)
(*      Table[{j*4, Sum[datasum/mcsum*histo[[i,j]], {i, 1, 35}]}, {j, 1, 35}]}, *)
(*     PlotJoined -> {False, True}, *)
(*     SymbolShape -> {PlotSymbol[Box, 0.9], PlotSymbol[Box, 0]}, *)
(*     PlotStyle -> {Dashing[{}]}, *)
(*     Frame -> True, *)
(*     Axes -> True, *)
(*     AxesOrigin -> {0, 0}, *)
(*     PlotRange -> {{0, 141}, {-40, 1000}}, *)
(*     FrameLabel -> {"Two-jet total energy (GeV)", None, None, None}, *)
(*     ImageSize -> 72*4 *)
(*     , DisplayFunction -> (Display["fake3_energy.eps", #, "EPS"]&) *)
(* 		]; *)

bowl13 = Table[chisquare[0.9, mc, 105.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_13.mx", bowl13];
bowl14 = Table[chisquare[0.9, mc, 106.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_14.mx", bowl14];
bowl15 = Table[chisquare[0.9, mc, 107.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_15.mx", bowl15];
bowl16 = Table[chisquare[0.9, mc, 108.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_16.mx", bowl16];
bowl17 = Table[chisquare[0.9, mc, 109.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_17.mx", bowl17];
bowl00 = Table[chisquare[0.9, mc, 92.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_00.mx", bowl00];
bowl01 = Table[chisquare[0.9, mc, 93.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_01.mx", bowl01];
bowl02 = Table[chisquare[0.9, mc, 94.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_02.mx", bowl02];
bowl03 = Table[chisquare[0.9, mc, 95.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_03.mx", bowl03];
bowl04 = Table[chisquare[0.9, mc, 96.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_04.mx", bowl04];
bowl05 = Table[chisquare[0.9, mc, 97.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_05.mx", bowl05];
bowl06 = Table[chisquare[0.9, mc, 98.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_06.mx", bowl06];
bowl07 = Table[chisquare[0.9, mc, 99.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_07.mx", bowl07];
bowl08 = Table[chisquare[0.9, mc, 100.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_08.mx", bowl08];
bowl09 = Table[chisquare[0.9, mc, 101.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_09.mx", bowl09];
bowl10 = Table[chisquare[0.9, mc, 102.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_10.mx", bowl10];
bowl11 = Table[chisquare[0.9, mc, 103.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_11.mx", bowl11];
bowl12 = Table[chisquare[0.9, mc, 104.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_12.mx", bowl12];
bowl18 = Table[chisquare[0.9, mc, 110.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_18.mx", bowl18];
bowl19 = Table[chisquare[0.9, mc, 111.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_19.mx", bowl19];
bowl20 = Table[chisquare[0.9, mc, 112.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_20.mx", bowl20];
bowl21 = Table[chisquare[0.9, mc, 113.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_21.mx", bowl21];
bowl22 = Table[chisquare[0.9, mc, 114.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_22.mx", bowl22];
bowl23 = Table[chisquare[0.9, mc, 115.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_23.mx", bowl23];
bowl24 = Table[chisquare[0.9, mc, 116.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_24.mx", bowl24];
bowl25 = Table[chisquare[0.9, mc, 117.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_25.mx", bowl25];
bowl26 = Table[chisquare[0.9, mc, 118.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_26.mx", bowl26];
bowl27 = Table[chisquare[0.9, mc, 119.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_27.mx", bowl27];
bowl28 = Table[chisquare[0.9, mc, 120.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_28.mx", bowl28];
bowl29 = Table[chisquare[0.9, mc, 121.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_29.mx", bowl29];
bowl30 = Table[chisquare[0.9, mc, 122.697], {mc, 159.417 - 15, 159.417 + 15, 1}];
DumpSave["fake3_30.mx", bowl30];
(* bowl = Table[If[Abs[mc-mlsp-51.72] < 7, *)
(* 		chisquare[0.9, mc, mlsp], *)
(* (\* ndof*(1 + ((mc-mlsp)-(159.417-107.697))^2/2.8^2 + (mlsp-107.697)^2/7^2), *\) *)
(* 		ndof*15^2], *)
(* 	     {mc, 159.417 - 15, 159.417 + 15, 1}, *)
(* 	     {mlsp, 107.697 - 15, 107.697 + 15, 1}]; *)
bowl = {bowl00, bowl01, bowl02, bowl03, bowl04, bowl05, bowl06,
	bowl07, bowl08, bowl09, bowl10, bowl11, bowl12, bowl13,
	bowl14, bowl15, bowl16, bowl17, bowl18, bowl19, bowl20,
	bowl21, bowl22, bowl23, bowl24, bowl25, bowl26, bowl27,
	bowl28, bowl29, bowl30};
mini = Min[Flatten[bowl]];
DumpSave["fake3.mx", bowl];

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.68269, v]

Out[11]= {{v -> 986.365}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.95, v]

Out[12]= {{v -> 1039.42}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.997, v]

Out[15]= {{v -> 1091.15}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.999936, v]

Out[18]= {{v -> 1143.54}}


ndof

Out[25]= 879

bowl = Table[If[Abs[mc-mlsp-51.72] < 3.,
		chisquare[0.9, mc, mlsp],
		ndof*15^2],
	     {mc, 159.417 - 10, 159.417 + 10, 1},
	     {mlsp, 107.697 - 10, 107.697 + 10, 1}];
DumpSave["fake5.mx"];

CompiledFunction::cfte: 
   Compiled expression {166.208 + 0. I, 0. + 0.117122 I, 0. + <<1>>, 
     0. - 7.4307 I} should be a rank 1 tensor of machine-size real numbers.

CompiledFunction::cfex: 
   External evaluation error at instruction 13; proceeding with uncompiled
     evaluation.

CompiledFunction::cfta: 
   Argument {180.25 - 0.441405 I, 0. + <<1>>, <<1>>, -69.75 + 1.14069 I}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

CompiledFunction::cfse: 
   Compiled expression 60.3543 + 0.604737 I should be a 
    machine-size real number.

CompiledFunction::cfex: 
   External evaluation error at instruction 30; proceeding with uncompiled
     evaluation.

CompiledFunction::cfte: 
   Compiled expression {166.208 + 0. I, 0. - 2.20636 I, 0. + <<1>>, 
     0. + 1.31968 I} should be a rank 1 tensor of machine-size real numbers.

CompiledFunction::cfex: 
   External evaluation error at instruction 13; proceeding with uncompiled
     evaluation.

General::stop: Further output of CompiledFunction::cfex
     will be suppressed during this calculation.

CompiledFunction::cfta: 
   Argument {180.25 - 3.44516 I, 0. + <<1>>, <<1>>, -69.75 + 8.90308 I}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

CompiledFunction::cfse: 
   Compiled expression 45.6946 + 0.658568 I should be a 
    machine-size real number.

CompiledFunction::cfte: 
   Compiled expression {166.208 + 0. I, 0. + 0.117264 I, 0. + <<1>>, 
     0. - 7.60206 I} should be a rank 1 tensor of machine-size real numbers.

General::stop: Further output of CompiledFunction::cfte
     will be suppressed during this calculation.

CompiledFunction::cfta: 
   Argument {180.25 + 2.55253 I, 0. + <<1>>, <<1>>, 69.75 + 6.59634 I}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

General::stop: Further output of CompiledFunction::cfta
     will be suppressed during this calculation.

CompiledFunction::cfse: 
   Compiled expression 58.6338 + 0.373548 I should be a 
    machine-size real number.

General::stop: Further output of CompiledFunction::cfse
     will be suppressed during this calculation.

Less::nord: Invalid comparison with 43.1043 + 0.479254 I attempted.

Greater::nord: Invalid comparison with 43.1043 + 0.479254 I attempted.

Less::nord: Invalid comparison with 53.8071 - 0.017013 I attempted.

Greater::nord: Invalid comparison with 53.8071 - 0.017013 I attempted.

Part::pspec: Part specification 14 - I
     is neither an integer nor a list of integers.

Part::pspec: Part specification 14 - I
     is neither an integer nor a list of integers.

Set::pspec: Part specification 14 - I
     is neither an integer nor a list of integers.

Less::nord: Invalid comparison with 61.2508 + 5.9147 I attempted.

General::stop: Further output of Less::nord
     will be suppressed during this calculation.

Greater::nord: Invalid comparison with 61.2508 + 5.9147 I attempted.

General::stop: Further output of Greater::nord
     will be suppressed during this calculation.

Part::pspec: Part specification 16 + I
     is neither an integer nor a list of integers.

General::stop: Further output of Part::pspec
     will be suppressed during this calculation.

Set::pspec: Part specification 16 + I
     is neither an integer nor a list of integers.

Set::pspec: Part specification 14 - I
     is neither an integer nor a list of integers.

General::stop: Further output of Set::pspec
     will be suppressed during this calculation.


Solve[CDF[ChiSquareDistribution[ndof],v] == 0.68269, v]

Solve::ifun: Inverse functions are being used by Solve, so some solutions may
     not be found; use Reduce for complete solution information.

Out[21]= {{v -> 898.401}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.95, v]

Solve::ifun: Inverse functions are being used by Solve, so some solutions may
     not be found; use Reduce for complete solution information.

Out[22]= {{v -> 949.084}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.997, v]

Solve::ifun: Inverse functions are being used by Solve, so some solutions may
     not be found; use Reduce for complete solution information.

Out[23]= {{v -> 998.58}}

Solve[CDF[ChiSquareDistribution[ndof],v] == 0.999936, v]

Solve::ifun: Inverse functions are being used by Solve, so some solutions may
     not be found; use Reduce for complete solution information.

Out[24]= {{v -> 1048.79}}




ListContourPlot[bowl,
		Frame -> True,
		FrameLabel -> {"Mass of chargino (centered on 159.417 GeV)", "Mass of LSP (centered on 107.697 GeV)", "Confidence Intervals with zeta = 0.9", None},
		PlotRange -> {All, All, {0, 1092}},
		Contours -> {898.401, 949.084, 998.58},
		ColorFunction -> (RGBColor[#^5, #^5, 1]&),
		FrameTicks -> {Join[{{1, "-10"}, {6, "-5"}, {11, "0"}, {16, "+5"}, {21, "+10"}, {26, "+15"}}, {#, ""}& /@ Range[1,26]],
			       Join[{{1, "-10"}, {6, "-5"}, {11, "0"}, {16, "+5"}, {21, "+10"}, {26, "+15"}}, {#, ""}& /@ Range[1,26]], {#, ""}& /@ Range[1,26], {#, ""}& /@ Range[1,26]}
		, ContourSmoothing -> False
		, DisplayFunction -> (Display["fake5_contours.eps", #, "EPS"]&) 
	       ];

















justzeta = Table[chisquare[zeta, 159.417+1, 107.697+0.9], {zeta, 0.8, 1.0, 0.1}]

Out[8]= {981.571, 979.196, 1081.89}

Fit[








<<NumericalMath`

gradient = {ND[chisquare[zeta, mc, mlsp], zeta,     0.9, Terms -> 2, Scale -> 0.1],
	    ND[chisquare[zeta, mc, mlsp], mc,   159.417, Terms -> 2, Scale -> 1.0],
	    ND[chisquare[zeta, mc, mlsp], mlsp, 107.697, Terms -> 2, Scale -> 1.0]};
hessianZZ = ND[ND[chisquare[zeta, mc, mlsp], zeta,     0.9, Terms -> 2, Scale -> 0.1], zeta,     0.9, Terms -> 2, Scale -> 0.1];
hessianZC = ND[ND[chisquare[zeta, mc, mlsp], zeta,     0.9, Terms -> 2, Scale -> 0.1], mc,   159.417, Terms -> 2, Scale -> 1.0];
hessianZL = ND[ND[chisquare[zeta, mc, mlsp], zeta,     0.9, Terms -> 2, Scale -> 0.1], mlsp, 107.697, Terms -> 2, Scale -> 1.0];
hessianCZ = hessianZC;
hessianCC = ND[ND[chisquare[zeta, mc, mlsp], mc,   159.417, Terms -> 2, Scale -> 1.0], mc,   159.417, Terms -> 2, Scale -> 1.0];
hessianCL = ND[ND[chisquare[zeta, mc, mlsp], mc,   159.417, Terms -> 2, Scale -> 1.0], mlsp, 107.697, Terms -> 2, Scale -> 1.0];
hessianLZ = hessianZL;
hessianLC = hessianCL;
hessianLL = ND[ND[chisquare[zeta, mc, mlsp], mlsp, 107.697, Terms -> 2, Scale -> 1.0], mlsp, 107.697, Terms -> 2, Scale -> 1.0];
{hessianLC, ND[ND[chisquare[zeta, mc, mlsp], mlsp, 107.697, Terms -> 2, Scale -> 1.0], mc,   159.417, Terms -> 2, Scale -> 1.0]}

CompiledFunction::cfsa: 
   Argument zeta at position 1 should be a machine-size real number.

Range::range: Range specification in Range[0, Floor[mc - mlsp], 1]
     is not a machine-size integer.

CompiledFunction::cfsa: 
   Argument zeta at position 1 should be a machine-size real number.

CompiledFunction::cfsa: 
   Argument zeta at position 1 should be a machine-size real number.

General::stop: Further output of CompiledFunction::cfsa
     will be suppressed during this calculation.

Range::range: Range specification in 
                              -8
    Range[0, <<1>>, 2.39095 10   <<1>> (-2 + <<4>> - 6 <<3>>)]
     is not a machine-size integer.

Random::randn: Range specification {0., mc - mlsp} in 
    Random[Real, {0., mc - mlsp}] is not a valid number or pair of numbers.

Random::randn: Range specification 
                                        -8
    {0., 1.05 Range[0, <<1>>, 2.39095 10   <<1>> (-2 + <<5>>)]} in 
                                                    -8
    Random[Real, {0., 1.05 Range[0, <<1>>, <<6>>5 10   <<2>>]}]
     is not a valid number or pair of numbers.

CompiledFunction::cfta: 
                                          10
   Argument {-0.0000118765 Sqrt[5.88063 10   + <<1>>] + <<1>>, <<3>>}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

Random::randn: Range specification {0., mc - 1. mlsp} in 
    Random[Real, {0., mc - 1. mlsp}] is not a valid number or pair of numbers.

General::stop: Further output of Random::randn
     will be suppressed during this calculation.

Part::pspec: Part specification 
              -6.97368 + Random[Real, {0., mc - mlsp}]
    1 + Floor[----------------------------------------]
                                 2
     is neither an integer nor a list of integers.

Part::pspec: Part specification 
              -6.97368 + Random[Real, {0., mc - mlsp}]
    1 + Floor[----------------------------------------]
                                 2
     is neither an integer nor a list of integers.

Set::pspec: Part specification 1 + 
           -6.97368 + Random[Real, {0., mc - mlsp}]
     Floor[----------------------------------------] is neither an integer nor
                              2
     a list of integers.

CompiledFunction::cfta: 
                       -8                10
   Argument {5.90603 10   Sqrt[6.22503 10   + <<1>>] + 1. <<1>>, <<3>>}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

Part::pspec: Part specification 
              2.84584 + Random[Real, {0., mc - mlsp}]
    1 + Floor[---------------------------------------]
                                 2
     is neither an integer nor a list of integers.

General::stop: Further output of Part::pspec
     will be suppressed during this calculation.

Set::pspec: Part specification 1 + 
           2.84584 + Random[Real, {0., mc - mlsp}]
     Floor[---------------------------------------] is neither an integer nor
                              2
     a list of integers.

CompiledFunction::cfta: 
                        -7                10
   Argument {-7.39093 10   Sqrt[6.22503 10   + <<1>>] + 1. <<1>>, <<3>>}
     at position 1 should be a rank 1 tensor of machine-size real numbers.

General::stop: Further output of CompiledFunction::cfta
     will be suppressed during this calculation.

Set::pspec: Part specification 1 + 
           4.75973 + Random[Real, {0., mc - mlsp}]
     Floor[---------------------------------------] is neither an integer nor
                              2
     a list of integers.

General::stop: Further output of Set::pspec
     will be suppressed during this calculation.

Range::range: Range specification in Range[0, Floor[mc - mlsp], 1]
     is not a machine-size integer.

General::stop: Further output of Range::range
     will be suppressed during this calculation.

Out[5]= {0., 0.}






































bowlie = Table[{zeta, mc, mlsp, chisquare[zeta, mc, mlsp]}, {zeta, 0.9-0.1, 0.9+0.1, 0.1}, {mc, 159.417 - 2, 159.417 + 2, 1}, {mlsp, 107.697 - 2, 107.697 + 2, 1}];



Fit[({#[[1]], #[[4]]}& /@ Select[Flatten[bowlie, 2], (#[[2]]==159.417 && #[[3]]==107.697)&]), {1, zeta, zeta^2}, {zeta}]

Out[123]= {{0.8, 1025.12}, {0.9, 967.905}, {1., 1087.15}}

                                               2
Out[124]= 7835.17 - 15570.8 zeta + 8822.75 zeta

FindMinimum[Out[124], {zeta, 0.9}]

Out[126]= {965.179, {zeta -> 0.882422}}



FindFit[Flatten[bowlie,2], a + b*(zeta-z0)^2 + c*(mc-mc0)^2 + d*(mlsp-mlsp0)^2 + e*(zeta-z0)*(mc-mc0) + f*(zeta-z0)*(mlsp-mlsp0) + g*(mc-mc0)*(mlsp-mlsp0), {a, b, c, d, e, f, g, z0, mc0, mlsp0}, {zeta, mc, mlsp}]

FindFit::cvmit: 
   Failed to converge to the requested accuracy or precision
     within 100 iterations.

Out[136]= {a -> 3585.93, b -> 9197.06, c -> 2.24051, 
 
>    d -> 10.5269, e -> -912.373, f -> 813.242, g -> -15.9697, 
 
>    z0 -> 2.66154, mc0 -> 90.2738, mlsp0 -> -10.0041}


bestfit = Fit[Flatten[bowlie, 2], {1, (zeta - 0.9)^2, (mc - 159.417)^2, (mlsp - 107.697)^2}, {zeta, mc, mlsp}]

                                          2
Out[132]= 986.892 + 46.426 (-159.417 + mc)  + 
 
                              2                        2
>    76.6833 (-107.697 + mlsp)  + 9299.24 (-0.9 + zeta)








Select[Flatten[bowlie, 2], (#[[1]]==0.9)&] // TableForm






FindMinimum[bestfit, {zeta, 0.9}, {mc, 159.417}, {mlsp, 107.697}]


DensityPlot[bestfit /. zeta -> 0.9, {mc, 159.417-10, 159.417+10}, {mlsp, 107.697-10, 107.697+10}, PlotRange->{945, 2000}];





Out[71]= {{{{0.8, 157.417, 105.697, 1096.91}, 
 
>      {0.8, 157.417, 106.697, 985.668}, {0.8, 157.417, 107.697, 1001.23}, 
 
>      {0.8, 157.417, 108.697, 1193.93}, {0.8, 157.417, 109.697, 1511.09}}, 
 
>     {{0.8, 158.417, 105.697, 1278.86}, {0.8, 158.417, 106.697, 1056.88}, 
 
>      {0.8, 158.417, 107.697, 967.6}, {0.8, 158.417, 108.697, 1058.07}, 
 
>      {0.8, 158.417, 109.697, 1261.61}}, 
 
>     {{0.8, 159.417, 105.697, 1646.24}, {0.8, 159.417, 106.697, 1280.25}, 
 
>      {0.8, 159.417, 107.697, 1025.12}, {0.8, 159.417, 108.697, 951.675}, 
 
>      {0.8, 159.417, 109.697, 1092.28}}, 
 
>     {{0.8, 160.417, 105.697, 2025.14}, {0.8, 160.417, 106.697, 1579.95}, 
 
>      {0.8, 160.417, 107.697, 1219.87}, {0.8, 160.417, 108.697, 1037.13}, 
 
>      {0.8, 160.417, 109.697, 1019.79}}, 
 
>     {{0.8, 161.417, 105.697, 2597.4}, {0.8, 161.417, 106.697, 1980.26}, 
 
>      {0.8, 161.417, 107.697, 1495.82}, {0.8, 161.417, 108.697, 1163.4}, 
 
>      {0.8, 161.417, 109.697, 1044.12}}}, 
 
>    {{{0.9, 157.417, 105.697, 1058.82}, {0.9, 157.417, 106.697, 992.251}, 
 
>      {0.9, 157.417, 107.697, 1083.53}, {0.9, 157.417, 108.697, 1397.44}, 
 
>      {0.9, 157.417, 109.697, 1715.17}}, 
 
>     {{0.9, 158.417, 105.697, 1191.73}, {0.9, 158.417, 106.697, 1017.69}, 
 
>      {0.9, 158.417, 107.697, 965.363}, {0.9, 158.417, 108.697, 1164.46}, 
 
>      {0.9, 158.417, 109.697, 1354.1}}, 
 
>     {{0.9, 159.417, 105.697, 1380.08}, {0.9, 159.417, 106.697, 1108.33}, 
 
>      {0.9, 159.417, 107.697, 967.905}, {0.9, 159.417, 108.697, 1027.42}, 
 
>      {0.9, 159.417, 109.697, 1205.7}}, 
 
>     {{0.9, 160.417, 105.697, 1750.48}, {0.9, 160.417, 106.697, 1315.47}, 
 
>      {0.9, 160.417, 107.697, 1052.52}, {0.9, 160.417, 108.697, 979.196}, 
 
>      {0.9, 160.417, 109.697, 1026.19}}, 
 
>     {{0.9, 161.417, 105.697, 2214.02}, {0.9, 161.417, 106.697, 1617.49}, 
 
>      {0.9, 161.417, 107.697, 1247.86}, {0.9, 161.417, 108.697, 1049.44}, 
 
>      {0.9, 161.417, 109.697, 945.117}}}, 
 
>    {{{1., 157.417, 105.697, 1147.69}, {1., 157.417, 106.697, 1213.55}, 
 
>      {1., 157.417, 107.697, 1392.34}, {1., 157.417, 108.697, 1759.45}, 
 
>      {1., 157.417, 109.697, 2164.46}}, 
 
>     {{1., 158.417, 105.697, 1230.87}, {1., 158.417, 106.697, 1134.53}, 
 
>      {1., 158.417, 107.697, 1223.31}, {1., 158.417, 108.697, 1446.26}, 
 
>      {1., 158.417, 109.697, 1801.31}}, 
 
>     {{1., 159.417, 105.697, 1390.93}, {1., 159.417, 106.697, 1169.44}, 
 
>      {1., 159.417, 107.697, 1087.15}, {1., 159.417, 108.697, 1245.18}, 
 
>      {1., 159.417, 109.697, 1425.43}}, 
 
>     {{1., 160.417, 105.697, 1637.37}, {1., 160.417, 106.697, 1277.05}, 
 
>      {1., 160.417, 107.697, 1100.71}, {1., 160.417, 108.697, 1058.91}, 
 
>      {1., 160.417, 109.697, 1268.87}}, 
 
>     {{1., 161.417, 105.697, 1869.54}, {1., 161.417, 106.697, 1414.64}, 
 
>      {1., 161.417, 107.697, 1183.26}, {1., 161.417, 108.697, 1027.25}, 
 
>      {1., 161.417, 109.697, 1065.34}}}}


















bowlie = {{{{0.8, 157.417, 105.697, 1096.91},  {0.8, 157.417, 106.697, 985.668}, {0.8, 157.417, 107.697, 1001.23},  {0.8, 157.417, 108.697, 1193.93}, {0.8, 157.417, 109.697, 1511.09}}, {{0.8, 158.417, 105.697, 1278.86}, {0.8, 158.417, 106.697, 1056.88},  {0.8, 158.417, 107.697, 967.6}, {0.8, 158.417, 108.697, 1058.07},  {0.8, 158.417, 109.697, 1261.61}}, {{0.8, 159.417, 105.697, 1646.24}, {0.8, 159.417, 106.697, 1280.25},  {0.8, 159.417, 107.697, 1025.12}, {0.8, 159.417, 108.697, 951.675},  {0.8, 159.417, 109.697, 1092.28}}, {{0.8, 160.417, 105.697, 2025.14}, {0.8, 160.417, 106.697, 1579.95},  {0.8, 160.417, 107.697, 1219.87}, {0.8, 160.417, 108.697, 1037.13},  {0.8, 160.417, 109.697, 1019.79}}, {{0.8, 161.417, 105.697, 2597.4}, {0.8, 161.417, 106.697, 1980.26},  {0.8, 161.417, 107.697, 1495.82}, {0.8, 161.417, 108.697, 1163.4},  {0.8, 161.417, 109.697, 1044.12}}}, 
     {{{0.9, 157.417, 105.697, 1058.82}, {0.9, 157.417, 106.697, 992.251},  {0.9, 157.417, 107.697, 1083.53}, {0.9, 157.417, 108.697, 1397.44},  {0.9, 157.417, 109.697, 1715.17}}, {{0.9, 158.417, 105.697, 1191.73}, {0.9, 158.417, 106.697, 1017.69},  {0.9, 158.417, 107.697, 965.363}, {0.9, 158.417, 108.697, 1164.46},  {0.9, 158.417, 109.697, 1354.1}}, {{0.9, 159.417, 105.697, 1380.08}, {0.9, 159.417, 106.697, 1108.33},  {0.9, 159.417, 107.697, 967.905}, {0.9, 159.417, 108.697, 1027.42},  {0.9, 159.417, 109.697, 1205.7}}, {{0.9, 160.417, 105.697, 1750.48}, {0.9, 160.417, 106.697, 1315.47},  {0.9, 160.417, 107.697, 1052.52}, {0.9, 160.417, 108.697, 979.196},  {0.9, 160.417, 109.697, 1026.19}}, {{0.9, 161.417, 105.697, 2214.02}, {0.9, 161.417, 106.697, 1617.49},  {0.9, 161.417, 107.697, 1247.86}, {0.9, 161.417, 108.697, 1049.44},  {0.9, 161.417, 109.697, 945.117}}}, 
     {{{1., 157.417, 105.697, 1147.69}, {1., 157.417, 106.697, 1213.55},  {1., 157.417, 107.697, 1392.34}, {1., 157.417, 108.697, 1759.45},  {1., 157.417, 109.697, 2164.46}}, {{1., 158.417, 105.697, 1230.87}, {1., 158.417, 106.697, 1134.53},  {1., 158.417, 107.697, 1223.31}, {1., 158.417, 108.697, 1446.26},  {1., 158.417, 109.697, 1801.31}}, {{1., 159.417, 105.697, 1390.93}, {1., 159.417, 106.697, 1169.44},  {1., 159.417, 107.697, 1087.15}, {1., 159.417, 108.697, 1245.18},  {1., 159.417, 109.697, 1425.43}}, {{1., 160.417, 105.697, 1637.37}, {1., 160.417, 106.697, 1277.05},  {1., 160.417, 107.697, 1100.71}, {1., 160.417, 108.697, 1058.91},  {1., 160.417, 109.697, 1268.87}}, {{1., 161.417, 105.697, 1869.54}, {1., 161.417, 106.697, 1414.64},  {1., 161.417, 107.697, 1183.26}, {1., 161.417, 108.697, 1027.25},  {1., 161.417, 109.697, 1065.34}}}};

data = {#[[1]], #[[4]]}& /@ Select[Flatten[bowlie,2], (#[[2]]==160.417 && #[[3]]==108.697)&]

Out[3]= {{0.8, 1037.13}, {0.9, 979.196}, {1., 1058.91}}

a+b*(x-c)^2 // Expand

                2                2
Out[19]= a + b c  - 2 b c x + b x


Fit[data, {1, x, x^2}, {x}]

                                       2
Out[20]= 6455.93 - 12279.4 x + 6882.4 x

Solve[6882.4*x^2==1, x]

Out[21]= {{x -> -0.012054}, {x -> 0.012054}}



