<< Graphics`Graphics`;
<< Graphics`MultipleListPlot`;

(* << Statistics`ContinuousDistributions` *)
(* rands = Table[Random[NormalDistribution[0,1]], {35}, {15}]; *)
rands =
{{-0.47855183840496246, 0.06546681385594097, 0.1458221716313335, 0.8303667365349716, 0.4807983035527738, 0.613077472619825, 
  0.6492505322478611, 0.1557417353021459, -0.5164047425748226, -1.712156561744614, 0.17687935722209347, 0.815864460776203, 
  0.39733731199751754, 0.7171346341734129, 0.5127790176286255}, {0.15958462666926754, 1.5969724931093598, -1.0248861366688382, 
  0.1953234217098768, -0.10921968428046963, 0.6811900405521939, 0.33958877676930155, 0.4802338249883066, 0.022448296716902395, 
  0.36475344339754273, 0.6471249125303881, 0.8031938166669903, 1.3369955758390062, 0.0366089673944282, -0.9390412414736102}, 
 {1.6153155217495032, 0.23484028316292369, 1.2385056239816057, -0.427507945384594, 0.8002142882151909, -0.504757896222111, 
  0.6517628302676327, -0.035846477801367106, -0.2467088528852006, -0.4439989027254613, -1.0839112567936735, 1.5710573094009144, 
  -0.8803629776284608, 0.25293260152538755, -0.4063526114697184}, {-0.5223757835149044, -0.04958941140012443, 0.36946814612768347, 
  0.7852828924624301, 2.0320531948062217, 1.8502762502332228, -1.7815242995300709, -1.0008078800020876, -0.4232147620335985, 
  1.120655454711022, -0.660449615533055, 0.10791792636416682, -0.21876580594239786, -1.3423725012479162, -1.4837130101000497}, 
 {-0.22039847117162648, -1.5544450025939753, -0.3727759338523542, 2.3982274468923896, 1.3461144219576562, -1.9817713687449325, 
  2.5761433377492287, 0.0826605435832612, 0.542433340932442, -1.2089124318395987, -1.184011697454046, 1.9516213877723037, 
  -0.5946657233717849, -0.4106308912393333, 0.44060058542287}, {-0.39933782706178783, -0.0708233111421134, 0.4467117793912075, 
  0.15850277444961114, -0.405848268083736, -1.1332564129794294, 0.9936051578210747, 1.5241840989544946, 1.2150180892417917, 
  -1.1422588820159676, -0.5534838998467436, 0.15351812701160994, -0.44883240057888985, 1.3510553332178044, -0.805837785500396}, 
 {-0.7904110248448419, 0.28091357586479704, -0.4011481168298849, -0.30380504703050965, 0.16573495620027645, -1.401787160487024, 
  0.6888445449668285, 0.21418883710560263, -0.14772144506419954, -0.9979558266848635, 0.7609168535325539, 0.46761054971196214, 
  0.6789698748730967, -0.07612903965110435, 1.8540351979559417}, {-1.1020939746705247, -0.34837522644606445, 1.8465594816890112, 
  0.3778167530165225, 1.3636072669481931, 1.3523803433695396, -0.8287726554427387, -0.06512646226744648, -0.3813324553348779, 
  0.9285466835090224, 0.25034127107978155, 0.76632940338225, -1.1658364376335053, -1.9396722594046722, -1.4917957903494499}, 
 {-1.3167640569080976, -1.9891336456238995, -2.0159940592571135, 1.1479360889366717, 0.37268262336539787, -1.1939654524818335, 
  0.42428143791892603, -0.8607778328722151, 1.5023515152095877, 1.5207060890592334, -1.5850134637734348, -0.33095245321069366, 
  0.4168642311122391, 0.7120149241719076, -0.6756991731283486}, {1.6133436635324252, -0.47356649526880734, -0.7009300870999733, 
  0.5091593419625804, 1.452485721175901, 0.7885741525976749, 0.24010402840105902, -1.9914787500173439, 1.0757771475365243, 
  -1.4550798462266945, 0.6910052601012993, 1.1390117106506705, 1.1242105883363458, 0.11612030547114269, -0.7349767754374231}, 
 {-0.9485035795864366, -1.149722477221064, -2.1773848892679277, 0.11170950958409825, 1.6770658730075612, -0.2440735845604857, 
  0.02121077222584808, -0.82615546526951, 0.710270449373634, -0.18712132916887184, -0.45043182840302076, -0.09547434724437301, 
  -0.566093746678339, -0.06258459995633085, 0.28006055081510867}, {2.794502556134249, -1.224836419174168, -0.7445163644583082, 
  1.2229643315468202, -1.7719365630272141, 0.8812706417594539, 1.003661668636909, -1.375406575375645, -0.6759967458172894, 
  0.7277176901148695, 1.1626598981833556, -0.0604336116069984, 1.3118797709471308, -0.9928531657524022, -1.696977452689929}, 
 {-0.14786798573777615, 2.165473472612431, -0.1971942629628998, 0.9016316810871646, -0.9631849364073598, -0.14555463451008477, 
  -0.5195231284612358, -0.7989356287016239, 1.7689286288743364, -0.737878367831269, -0.805366452415503, 1.4433500240506623, 
  -0.11908172958072913, 1.45437038253848, 2.1503587116234546}, {1.0098197229713566, -0.6310397888699153, -0.8398990868673789, 
  -0.6779320589602289, 0.43805249998986856, 0.1875986039890846, -0.8990365899426491, -0.3861854305793058, -0.7584206699458895, 
  0.9975844342125324, 0.03223276206352732, 1.1538902880991573, 0.5228248563247093, -0.35654833715416784, -0.5593935828851527}, 
 {0.5333479122066658, -0.44244204465149717, 0.2496637233858234, 0.6252892563399329, 0.34080301766213017, 1.0452421052306953, 
  0.7357785090798141, -1.1288470180645003, 0.23015631054882932, -0.5523536180491255, 0.386857005770904, 1.5132010428170692, 
  0.02903090706401036, -0.5859791008690614, 1.9856070755040305}, {0.5511768129741955, -0.26725528942417653, -0.168321523693496, 
  -2.0907861760198134, -1.0386945096868838, -0.6074050810374862, 0.4564332224397958, -0.9757388881446283, -0.744294172803251, 
  -0.36992012965968596, 1.6520280845570698, 0.2817998342028687, 1.0143961489952191, 1.3836195152001083, -0.08353033439091596}, 
 {-1.725198089141211, 0.8029500427619132, 0.20311992241276322, 0.5589074872082339, -0.19818400500048577, -0.40123572320347867, 
  1.061154255742478, -0.7765581249010443, -0.0031141933712390394, -1.8193858325982495, 0.3826729032140131, 1.2398366730346766, 
  -0.754462340559853, 0.8310946180521396, -0.8502989557755284}, {1.7395030362068493, -0.2760469880543396, -1.3899938863368786, 
  -0.14448297015444722, 0.5478794659900458, -0.0843404626724059, -0.8098522932574113, 0.15494746180710475, 0.3555215555561029, 
  -0.392867980793468, 0.710322649120902, 1.1004008759450243, 0.6687163302171917, -0.7001804412575197, -0.09980343631446523}, 
 {0.03816032758247691, 0.6786728233136162, -0.38920028325926925, -1.387031557439589, 0.9882541552063155, -0.9956060172933574, 
  -1.1006516727038458, 0.013394233604060713, -1.1908019948193211, 0.3314662331511382, 1.0416756621032075, -0.5996666644607566, 
  0.19237358445687439, -0.36995022893273305, 2.0308972675284114}, {0.825940709360582, 0.009337622493437855, -1.1893506574739636, 
  0.41689119188049895, -0.07116970579581806, 0.4030679088526441, 0.5118380311971918, 1.3076730079537402, 0.8053525509455248, 
  -0.6937560247361716, -0.9590716325239874, 0.47693780029828764, -0.45466477097304153, 0.6219199252140424, 1.1403311110934913}, 
 {0.3434428679955932, -0.8678441146782401, 2.5443476534820135, -1.1038634638528917, 0.3796328201299779, -0.09632249003796747, 
  -1.1473231864020914, 0.6768390049496498, -1.2199033796148047, -0.5835842452678279, -1.2566813699233177, -0.4365101923737845, 
  0.11757163751620545, 0.7747156214610714, 0.17003198756405494}, {-0.6755203732305711, -0.5592671917273585, 1.136758405482406, 
  0.6588746750730065, 0.7753753403863939, -2.621694003471824, -0.939294434111319, 0.784110373702196, -2.4190663196515216, 
  0.7644703828275957, -1.4255349980168515, -0.753420617489153, 1.0409509010319307, 0.1414370199075775, -0.14604597245687942}, 
 {-0.4202659142480171, -0.349314598985565, 0.5076468572542269, -2.3541861208494157, 1.7316735223628186, 0.6116508069402905, 
  0.0840483266033701, -0.05582770597061469, -1.4847069307471865, -1.0100024761617405, -0.353641853308795, -0.16239185924876814, 
  0.8080740096003866, 1.1956899331869915, 0.7784151275355299}, {-0.9443105202762171, 1.345296295271702, 0.5774009505231094, 
  0.5840610212925909, -0.5633113634982369, -0.6737710928202438, 0.9570446111788754, 0.7772924542652733, -0.8011895772743203, 
  0.8062613147375046, -1.6459212214495273, -0.13476126756076404, 0.32572883804617264, -0.7108215341384309, 1.7311032508460333}, 
 {-1.7755778306852734, -1.1737733384682179, -0.046907701809610666, -0.28470377218571497, -0.007845090836633536, 0.755335716413042, 
  1.9240212588906531, -1.4774693867066477, 0.6241393607665512, -0.7908051160910116, -0.834270050412869, -0.9765227440658133, 
  0.9868430698827169, 0.06306036858893499, -0.8510822207890034}, {0.523914980462045, -0.36153636023287083, 1.0725402112321523, 
  -0.20057517637428252, -0.93425214723412, -0.9495628344690722, 0.9656637865438339, 0.28179842519729204, -1.4593776620987282, 
  0.7787119386863969, 0.4702469762839807, -2.01829714645847, -0.03757236400173227, 1.4774577130884685, 1.6101651930297303}, 
 {0.27751276287209203, -0.5659224250955128, -0.16057513997526776, -1.5221832065358587, 0.06853278913417006, 3.050485418370919, 
  1.2555913984637948, 0.3338579716853361, -1.4441523903399582, -1.4837329878469125, -0.23077506162018271, -1.3513094180217176, 
  -0.11021983879598171, 1.15175837601374, -0.5436497262026498}, {-1.9151729963447606, 0.5121466924725747, -1.904001499972304, 
  0.5586057789430623, -0.7987425957802997, -1.099633103261702, 1.6770614207621222, 1.0643976781416735, -0.2091114456350338, 
  -0.03322334463531241, 0.08797431417680471, 0.9128324779077898, -0.30420782596999746, -1.822115313223946, 0.803827735320252}, 
 {-1.4902990085929377, 0.3346717213592614, 0.6771945082119039, 0.8437884739790631, 1.684436554332858, -0.7317056458422407, 
  -0.6648171663216151, -0.9713877673728024, 1.3279757005633894, -0.33406543406848754, -0.036898767658435756, -0.7834783854799103, 
  0.08427561497973428, -0.198687155642124, 0.11004778973485675}, {-0.25885428591358833, 0.44608971264236447, 0.5831096238247164, 
  0.6575859934879136, 0.34718597230245535, -0.4184115779097988, 0.5397617123921362, 1.4785194613245962, -0.11343798137923616, 
  -0.18384995674893023, 0.41697695277844504, -0.9454901852265414, -0.8003057721681497, -0.29687656070047685, 0.056500741219054344}, 
 {-1.2850361440945826, -1.2520704139601333, 1.0467659168892995, -0.08155365850670053, 0.5035010546147876, -2.9810343113486533, 
  1.1085347887465646, -1.980354874744869, -0.782427686015614, 0.8465173465540006, -0.027542597603115202, 0.45307314941061166, 
  -0.24242398530007972, -1.235871992281558, 1.6044058454269654}, {0.738699704518765, 1.3417554908362077, -1.008384169081009, 
  1.3547515572296494, 0.9838172740396256, -0.08573769925051847, 0.712158268225423, 3.010597964811999, 1.2932987647741903, 
  -0.13628336011306721, 0.11372283859042394, -0.6756379885449748, -1.3542432053783398, -0.9163311171508965, 0.8975044989993184}, 
 {-2.3409758988164904, 1.3772398569792417, 0.4889214408834377, 0.8257255358091574, 0.5768872127886929, -0.4099322267502102, 
  0.8236772266981977, 0.4963337568595179, -0.32790042038419354, -0.23171507814313416, 0.38291193645305394, -0.05810098589225925, 
  -0.1745321763656268, -0.3746683178714189, -1.661158698454912}, {-1.5786585781139508, -0.32640469289327545, 0.0918412132981731, 
  -1.5583079661528547, 0.25247119579486826, 1.373190444209203, -1.7018534248335924, 0.011580710833016013, -0.5848490065529685, 
  0.1711826415194368, 1.3779753149295346, -0.7674124009484334, -2.174657701449289, 0.27005883752069465, -0.22290384322328546}, 
 {-0.2661254265583553, 0.9493203468375213, 0.25092090512467713, -0.8085130790112635, 0.8402129325353257, 2.1858233327946253, 
  0.8240368307320377, 0.7268377419873208, -0.2594843386972589, -0.8573859296355066, -1.1842482969357155, 0.9124277208992917, 
  -0.8647717896839399, 0.5173421475359573, 1.259131570027526}};
vals = {{39.583, 34.4882, 36.0558, 34.4882, 30.1771, 30.1771, 20.3794, 16.0683, 21.1632, 13.7169, 2.35147, 0, 0, 0, 0},
	{39.583, 41.9345, 45.4617, 32.9205, 32.1367, 32.5286, 34.0963, 18.8117, 22.7308, 13.325, 6.27058, 0, 0, 0, 0},
	{40.7587, 43.5021, 36.8396, 43.1102, 38.0154, 38.4073, 30.961, 26.258, 18.8117, 10.1897, 2.74338, 0, 0, 0, 0},
	{44.6778, 33.7043, 48.597, 43.1102, 36.4477, 33.3124, 40.7587, 27.4338, 20.3794, 12.5412, 5.09484, 0, 0, 0, 0},
	{36.8396, 36.8396, 42.7183, 44.6778, 44.6778, 35.6639, 39.9749, 26.258, 20.7713, 17.2441, 3.91911, 0, 0, 0, 0},
	{47.0293, 49.7727, 46.2455, 43.894, 43.894, 32.1367, 31.7448, 22.3389, 19.5955, 11.7573, 4.70293, 0, 0, 0, 0},
	{40.7587, 43.1102, 35.6639, 41.5426, 43.1102, 35.6639, 32.5286, 34.8801, 21.1632, 15.2845, 1.56764, 0, 0, 0, 0},
	{44.6778, 41.5426, 47.4212, 38.7992, 34.8801, 41.5426, 38.0154, 28.2176, 21.1632, 12.9331, 2.74338, 0, 0, 0, 0},
	{44.6778, 41.5426, 36.4477, 48.205, 36.8396, 39.1911, 37.2315, 26.6499, 19.5955, 10.5816, 3.5272, 0, 0, 0, 0},
	{44.6778, 48.205, 42.3264, 43.5021, 33.7043, 30.961, 21.947, 34.4882, 20.3794, 12.9331, 2.35147, 0, 0, 0, 0},
	{47.0293, 41.9345, 47.8131, 42.7183, 41.1507, 36.8396, 33.7043, 20.7713, 18.4198, 9.40586, 0.391911, 0, 0, 0, 0},
	{46.2455, 42.7183, 39.9749, 40.3668, 39.9749, 41.5426, 24.2985, 25.0823, 17.636, 2.74338, 0, 0, 0, 0, 0},
	{37.2315, 51.7322, 40.7587, 39.1911, 42.3264, 35.6639, 25.8661, 21.5551, 17.636, 4.70293, 0, 0, 0, 0, 0},
	{37.2315, 42.7183, 41.5426, 44.6778, 32.1367, 23.5147, 27.8257, 21.947, 14.5007, 1.17573, 0, 0, 0, 0, 0},
	{41.5426, 34.0963, 39.1911, 32.5286, 27.4338, 27.4338, 21.947, 16.8522, 4.70293, 0, 0, 0, 0, 0, 0},
	{38.4073, 39.1911, 32.1367, 34.4882, 25.4742, 29.3933, 18.8117, 12.1492, 1.95955, 0, 0, 0, 0, 0, 0},
	{40.7587, 26.6499, 30.5691, 27.4338, 26.258, 22.3389, 14.1088, 4.31102, 0, 0, 0, 0, 0, 0, 0},
	{35.6639, 34.0963, 32.9205, 24.6904, 22.3389, 11.7573, 9.40586, 0, 0, 0, 0, 0, 0, 0, 0},
	{27.4338, 36.4477, 27.4338, 24.2985, 21.947, 10.1897, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{28.6095, 17.2441, 22.7308, 12.9331, 6.27058, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{17.636, 13.7169, 8.62204, 3.5272, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{12.1492, 6.27058, 1.17573, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0.783822, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
err2s = {{39.708, 35.306, 51.8656, 34.7382, 30.4271, 31.0472, 21.4472, 17.9949, 28.9033, 14.3133, 3.3425, 0.471415, 0.471415, 1.21647, 1.59977},
	 {40.083, 42.7809, 45.8081, 33.5169, 32.6081, 33.2786, 35.4819, 18.9849, 23.6737, 13.7964, 6.56878, 0.692829, 1.11604, 0.773645, 1.38566},
	 {41.186, 43.7521, 36.8396, 43.1102, 38.6404, 38.8787, 32.1252, 27.1045, 19.1099, 11.1325, 4.15762, 2.59081, 0.721415, 1.38566, 1.03924},
	 {61.434, 33.7043, 48.722, 59.3663, 37.5678, 34.1588, 41.4802, 28.723, 21.4186, 29.4263, 6.03767, 0.721415, 0.942829, 0.946852, 1.98207},
	 {46.3335, 36.9646, 43.5401, 45.5243, 44.8029, 35.6639, 40.3499, 26.8545, 21.3677, 18.0905, 4.73694, 0.471415, 0.5, 0.471415, 1.63566},
	 {47.1543, 50.0227, 46.3705, 66.4802, 44.2404, 32.4831, 32.4662, 22.4639, 20.192, 12.4502, 6.44397, 1.89798, 0.519622, 1.33745, 26.4937},
	 {57.5148, 43.3602, 37.0781, 267.334, 43.8839, 47.7573, 49.3504, 35.3801, 21.7596, 15.6309, 1.91406, 0.125, 0.817829, 1.19283, 26.0263},
	 {44.8029, 42.3162, 48.2676, 38.7992, 35.8515, 42.0908, 38.4868, 28.939, 21.1632, 14.3031, 4.04494, 1.21647, 1.16424, 1.19283, 0.471415},
	 {44.8029, 41.5426, 37.3906, 48.8497, 37.6861, 39.3643, 37.5298, 26.8999, 20.071, 11.2262, 3.87361, 1.16424, 42.5651, 0.721415, 1.68789},
	 {46.2817, 48.7051, 42.5764, 44.3682, 33.9543, 31.211, 22.6684, 35.4596, 21.6686, 13.5295, 2.87109, 0.25, 17.1047, 1.07588, 1.51066},
	 {48.0244, 42.2367, 48.5346, 42.8433, 41.1507, 36.8396, 34.1758, 21.9355, 18.7662, 9.40586, 2.16489, 0.942829, 0.721415, 2.03028, 18.6634},
	 {46.2455, 43.3433, 40.2772, 40.8382, 40.5794, 41.6676, 24.7699, 25.2595, 18.5788, 3.39202, 0.596415, 0.125, 0.519622, 1.19283, 0.596415},
	 {37.2315, 51.9095, 40.7587, 55.3227, 42.6286, 35.9661, 26.0434, 22.0551, 18.3655, 5.29935, 0.600438, 1.17772, 0.471415, 1.24506, 0.629511},
	 {39.1295, 42.7183, 42.0662, 44.8029, 32.1367, 23.9419, 27.9507, 22.4184, 14.6739, 1.94938, 0.721415, 0.769622, 0.25, 0.375, 16.7915},
	 {42.139, 34.0963, 39.3161, 32.875, 27.7882, 27.6838, 22.2934, 16.9772, 5.42435, 0.625, 0.423207, 0.817829, 0.55223, 0.991036, 1.28924},
	 {38.6573, 39.5375, 32.2617, 34.4882, 25.4742, 29.6433, 19.0617, 12.1492, 24.223, 0.125, 28.7368, 0.548207, 0.596415, 18.1367, 25.9039},
	 {41.3632, 26.8272, 46.3789, 28.3846, 26.7817, 22.9876, 14.9552, 4.95967, 0.971415, 0.25, 0.675274, 0.125, 1.21647, 16.7915, 1.06783},
	 {35.9661, 60.3226, 32.9205, 24.9926, 22.3389, 28.6078, 10.0545, 0.17723, 0.346415, 0.17723, 0.773645, 0.625, 1.02364, 1.06783, 2.24439},
	 {48.7935, 36.625, 27.7802, 24.5485, 21.947, 10.1897, 0.346415, 26.6311, 0.346415, 0.870059, 0.692829, 1.09641, 0.773645, 1.54327, 0},
	 {28.6095, 17.3691, 22.7308, 13.5375, 6.64558, 0, 0.375, 0, 0.471415, 0.471415, 0.173207, 0.673207, 1.777, 0.995059, 88.355},
	 {17.636, 13.7169, 8.74704, 3.6522, 0, 0.125, 0.692829, 0.25, 0, 0.25, 0.471415, 0.25, 27.258, 1.41827, 0.42723},
	 {12.1492, 6.61699, 1.17573, 0.30223, 0.346415, 0.817829, 0.346415, 0.375, 0.60446, 0.5, 25.9605, 1.88287, 0.644622, 23.0413, 0.870059},
	 {0.908822, 0, 0.17723, 0.675274, 25.4103, 0.125, 16.1137, 0.298207, 0, 0.25, 0.346415, 0.30223, 0.25, 0.173207, 0.898645},
	 {0.25, 0.298207, 0, 0.25, 0, 0.42723, 0, 0, 0.596415, 0.648645, 0.125, 0.25, 0.17723, 0.25, 0.648645},
	 {0, 0.30223, 0.471415, 1.42656, 0.346415, 1.77298, 0.30223, 0, 0.995059, 0.125, 26.4096, 16.1798, 0.375, 0.600438, 0.769622},
	 {0, 0, 0, 0.125, 0.25, 0, 0.346415, 0.30223, 0.30223, 0, 0.721415, 0, 0.692829, 0.173207, 0.471415},
	 {0.125, 0, 0, 0.30223, 0, 0.47946, 0.47946, 0.346415, 0.42723, 0.125, 0.656691, 0.25, 0, 0.817829, 3.60155},
	 {0, 0.30223, 0.375, 0, 0, 0, 0, 0, 16.8218, 0, 0, 0, 16.3201, 0.995059, 0.825875},
	 {0.173207, 0, 0, 0, 0.30223, 0, 0.692829, 0, 0.125, 0, 0.471415, 17.6099, 0.471415, 0.25, 0.42723},
	 {0, 0, 0, 0, 0, 0, 0.17723, 0.173207, 0.30223, 17.8425, 0.42723, 0.471415, 0, 0, 1.70523},
	 {0, 0.346415, 0, 0.17723, 0.30223, 0.817829, 0, 0, 16.1137, 0.471415, 0.523645, 0.25, 15.8471, 0, 0.346415},
	 {0, 0, 0.125, 0, 0, 0, 0.42723, 16.4601, 0, 0, 0.25, 0.17723, 17.5884, 16.9164, 0.596415},
	 {0, 0, 0, 0.125, 0.30223, 0.30223, 0.125, 0.346415, 0, 0.125, 0, 0.817829, 0.5, 0, 0.173207},
	 {0.125, 0, 0.125, 0, 0, 0.17723, 0.125, 0.30223, 0.125, 0.35446, 0, 0, 0.47946, 42.74, 25.6759},
	 {0, 0.471415, 0, 0, 0.125, 0, 0, 0.17723, 0, 0.471415, 0.17723, 0.125, 13.9457, 0.47946, 0}};
data = Table[{vals[[j,i]] + rands[[j,i]]*Sqrt[err2s[[j,i]]],
	      Sqrt[err2s[[j,i]]]}, {i, 1, 15}, {j, 1, 35}];
datasum = Sum[data[[i,j,1]], {i, 1, 15}, {j, 1, 35}];
dataerr = Sqrt[Sum[data[[i,j,2]]^2, {i, 1, 15}, {j, 1, 35}]];

isr[x_] = 0;
isr[1] = 3930;
isr[2] = 930;
isr[3] = 661;
isr[4] = 532;
isr[5] = 460;
isr[6] = 444;
isr[7] = 372;
isr[8] = 376;
isr[9] = 336;
isr[10] = 315;
isr[11] = 279;
isr[12] = 297;
isr[13] = 309;
isr[14] = 270;
isr[15] = 278;
isr[16] = 240;
isr[17] = 260;
isr[18] = 232;
isr[19] = 243;
isr[20] = 233;
isr[21] = 218;
isr[22] = 193;
isr[23] = 199;
isr[24] = 209;
isr[25] = 214;
isr[26] = 205;
isr[27] = 198;
isr[28] = 172;
isr[29] = 181;
isr[30] = 186;
isr[31] = 168;
isr[32] = 167;
isr[33] = 169;
isr[34] = 164;
isr[35] = 161;
isr[36] = 160;
isr[37] = 162;
isr[38] = 153;
isr[39] = 143;
isr[40] = 140;
isr[41] = 145;
isr[42] = 155;
isr[43] = 125;
isr[44] = 124;
isr[45] = 119;
isr[46] = 108;
isr[47] = 115;
isr[48] = 105;
isr[49] = 116;
isr[50] = 110;
isr[51] = 96;
isr[52] = 107;
isr[53] = 101;
isr[54] = 108;
isr[55] = 98;
isr[56] = 100;
isr[57] = 121;
isr[58] = 103;
isr[59] = 111;
isr[60] = 106;
isr[61] = 81;
isr[62] = 86;
isr[63] = 86;
isr[64] = 72;
isr[65] = 85;
isr[66] = 91;
isr[67] = 95;
isr[68] = 91;
isr[69] = 76;
isr[70] = 72;
isr[71] = 80;
isr[72] = 78;
isr[73] = 74;
isr[74] = 72;
isr[75] = 82;
isr[76] = 69;
isr[77] = 72;
isr[78] = 55;
isr[79] = 67;
isr[80] = 67;
isr[81] = 85;
isr[82] = 50;
isr[83] = 71;
isr[84] = 50;
isr[85] = 65;
isr[86] = 62;
isr[87] = 34;
isr[88] = 46;
isr[89] = 49;
isr[90] = 39;
isr[91] = 37;
isr[92] = 61;
isr[93] = 44;
isr[94] = 45;
isr[95] = 43;
isr[96] = 32;
isr[97] = 33;
isr[98] = 38;
isr[99] = 45;
isr[100] = 36;
isr[101] = 37;
isr[102] = 29;
isr[103] = 38;
isr[104] = 30;
isr[105] = 33;
isr[106] = 26;
isr[107] = 31;
isr[108] = 39;
isr[109] = 27;
isr[110] = 26;
isr[111] = 29;
isr[112] = 26;
isr[113] = 20;
isr[114] = 29;
isr[115] = 26;
isr[116] = 26;
isr[117] = 16;
isr[118] = 28;
isr[119] = 18;
isr[120] = 19;
isr[121] = 15;
isr[122] = 15;
isr[123] = 11;
isr[124] = 12;
isr[125] = 10;
isr[126] = 4;
isr[127] = 5;
isr[128] = 12;
isr[129] = 6;
isr[130] = 3;
isr[131] = 7;
isr[132] = 1;
isr[133] = 3;
isr[134] = 4;
isr[135] = 2;
isr[136] = 3;
isr[137] = 2;
isr[138] = 0;
isr[139] = 2;
isr[140] = 0;
isr[141] = 1;
fakeisr =
 Compile[{}, If[Random[] < 0.196314, 1,
		 (x = Random[Integer, {2, 140}];
		 y = Random[Integer, 930];
		 While[y > isr[x],
			 (x = Random[Integer, {2, 140}];
			 y = Random[Integer, 930];)];
		 x)] - 0.5];
andreasuncompiled[zeta_, mc_, mlsp_, mw_] =
 (mw * Sqrt[(mc^2-mlsp^2)^2 - 2*mw^2*(mc^2+mlsp^2) + mw^4] / (mw^2-80.425^2)^2) *
 ((mlsp^4 + mc^4 + mw^2*mc^2 - 2*mw^4 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc);
andreas =
 Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}, {mw, _Real}},
	 (mw * Sqrt[(mc^2-mlsp^2)^2 - 2*mw^2*(mc^2+mlsp^2) + mw^4] / (mw^2-80.425^2)^2) *
	 ((mlsp^4 + mc^4 + mw^2*mc^2 - 2*mw^4 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc)
	 ];
(* mw^4 < (mc-mlsp)^4 < (mc^2 - mlsp^2)^2 and any positive subtraction is dropped. *)
(* bigger[zeta_, mc_, mlsp_, mw_] := *)
(* (mw * Sqrt[(mc^2-mlsp^2)^2 + (mc-mlsp)^4] / (mw^2-80.425^2)^2) * *)
(* ((mlsp^4 + mc^4 + mw^2*mc^2 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc); *)
(* Plot[{andreas[0.9, 150., 109., mw], bigger[0.9, 150., 109., mw]}, {mw, 0, (150. - 109.)}]; *)
(* solutions = FullSimplify[Solve[ *)
(* FullSimplify[D[bigger[zeta, mc, mlsp, mw], mw]] == 0, mw]]; *)
(* mw /. (solutions[[4]] /. {mc -> 150, mlsp -> 109, zeta -> 0.9}) *)
(* Out[132]= 30.9881 *)
(* InputForm[mw /. solutions[[4]]] *)
(* bigger = *)
(* Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}, {mw, _Real}}, *)
(* 	 (mw * Sqrt[(mc^2-mlsp^2)^2 + (mc-mlsp)^4] / (mw^2-80.425^2)^2) * *)
(* 	 ((mlsp^4 + mc^4 + mw^2*mc^2 + mlsp^2*(mw^2-2*mc^2)) - 6*zeta*mw^2*mlsp*mc) *)
(* 	 ]; *)
(* topmw = *)
(* Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}}, *)
(* 0.5*Sqrt[-38809.083750000005 + (1.*mc^4 - 9.094947017729282*^-13*mlsp^2 + *)
(* 1.*mlsp^4 + mc^2*(-2.7284841053187847*^-12 - 2.*mlsp^2))/ *)
(* (-0.16666666666666669*mc^2 - 0.16666666666666669*mlsp^2 + *)
(* 1.*mc*mlsp*zeta) + *)
(* 2.*Sqrt[((2.794365053950512*^17*mc^4 + mc^2*(1.8074457901139779*^21 - *)
(* 5.588730107901024*^17*mlsp^2) + 2.794365053950512*^17*mlsp^2* *)
(* (6468.180625 + mlsp^2) - 1.084467474068387*^22*mc*mlsp*zeta)^2 - *)
(* 4.*(6.024819300379928*^20*mc^4 - 1.2049638600759855*^21*mc^2*mlsp^2 + *)
(* 6.024819300379928*^20*mlsp^4)*(9.31455017983504*^16*mc^2 + *)
(* 9.31455017983504*^16*mlsp^2 - 5.588730107901024*^17*mc*mlsp*zeta))/ *)
(* (9.31455017983504*^16*mc^2 + 9.31455017983504*^16*mlsp^2 - *)
(* 5.588730107901024*^17*mc*mlsp*zeta)^2]] *)
(* 	 ]; *)
(* topofandreas = *)
(* Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}}, *)
(* 	 bigger[zeta, mc, mlsp, topmw[zeta, mc, mlsp]] *)
(* 	 ]; *)
(* topofandreas[zeta_, mc_, mlsp_] := -FindMinimum[-andreasuncompiled[zeta, mc, mlsp, q], {q, (mc-mlsp)/2}][[1]]; *)
topofandreas[zeta_, mc_, mlsp_] :=
    Max[andreas[zeta, mc, mlsp, #]& /@ Range[0, Floor[mc - mlsp], 1]] * 1.05;
randomandreas =
 Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}, {top, _Real}},
	 (x = Random[Real, {0., (mc - mlsp)}];
	 y = Random[Real, {0., top}];
	 While[y > andreas[zeta, mc, mlsp, x],
		 (x = Random[Real, {0., (mc - mlsp)}];
		 y = Random[Real, {0., top}])];
	 x)];
randomdirection =
 Compile[{},
	 (costheta = Random[Real, {-1., 1.}];
	 sintheta = If[costheta > 0., 1., -1.] * Sqrt[1. - costheta^2];
	 phi = Random[Real, {0., 2.*Pi}];
	 {sintheta*Cos[phi], sintheta*Sin[phi], costheta}
	 )];
(* randomtwobody = *)
(* Compile[{{parent, _Real, 1}, {m1, _Real}, {m2, _Real}}, *)
(* 	 (m0 = Sqrt[parent[[1]]^2 - parent[[2]]^2 - parent[[3]]^2 - parent[[4]]^2]; *)
(* 	 pmag = Sqrt[m0^4 - 2*m0^2*m1^2 + m1^4 - 2*m0^2*m2^2 - 2*m1^2*m2^2 + m2^4]/2/m0; *)
(* 	 p1 = pmag*randomdirection[]; *)
(* 	 p2 = -p1; *)
(* 	 p1 = {Sqrt[p1[[1]]^2 + p1[[2]]^2 + p1[[3]]^2 + m1^2], p1[[1]], p1[[2]], p1[[3]]}; *)
(* 	 p2 = {Sqrt[p2[[1]]^2 + p2[[2]]^2 + p2[[3]]^2 + m2^2], p2[[1]], p2[[2]], p2[[3]]}; *)
(* 	 bx = parent[[2]]/parent[[1]]; *)
(* 	 by = parent[[3]]/parent[[1]]; *)
(* 	 bz = parent[[4]]/parent[[1]]; *)
(* 	 gam = 1/Sqrt[1 - bx^2 - by^2 - bz^2]; *)
(* 	 g2 = gam^2/(1+gam); *)
(* 	 boost = {{gam, gam*bx, gam*by, gam*bz}, *)
(* 		 {gam*bx, 1+g2*bx^2, g2*bx*by, g2*bx*bz}, *)
(* 		 {gam*by, g2*bx*by, 1+g2*by^2, g2*by*bz}, *)
(* 		 {gam*bz, g2*bx*bz, g2*by*bz, 1+g2*bz^2}}; *)
(* 	 {boost . p1, p2 = boost . p2} *)
(* 	 ), {{boost, _Real, 2}, {p1, _Real, 1}, {p2, _Real, 1}}]; *)
randomtwobody =
 Compile[{{parent, _Real, 1}, {m1, _Real}, {m2, _Real}},
	 (m0 = Sqrt[parent[[1]]^2 - parent[[2]]^2 - parent[[3]]^2 - parent[[4]]^2];
	 pmag = Sqrt[m0^4 - 2*m0^2*m1^2 + m1^4 - 2*m0^2*m2^2 - 2*m1^2*m2^2 + m2^4]/2/m0;
	 p1 = pmag*randomdirection[];
	 p1 = {Sqrt[p1[[1]]^2 + p1[[2]]^2 + p1[[3]]^2 + m1^2], p1[[1]], p1[[2]], p1[[3]]};
	 bx = parent[[2]]/parent[[1]];
	 by = parent[[3]]/parent[[1]];
	 bz = parent[[4]]/parent[[1]];
	 gam = 1/Sqrt[1 - bx^2 - by^2 - bz^2];
	 g2 = gam^2/(1+gam);
	 boost = {{gam, gam*bx, gam*by, gam*bz},
		 {gam*bx, 1+g2*bx^2, g2*bx*by, g2*bx*bz},
		 {gam*by, g2*bx*by, 1+g2*by^2, g2*by*bz},
		 {gam*bz, g2*bx*bz, g2*by*bz, 1+g2*bz^2}};
	 boost . p1
	 ), {{boost, _Real, 2}, {p1, _Real, 1}, {p2, _Real, 1}}];
jetconfused =
 Compile[{{jx, _Real}, {jy, _Real}, {jz, _Real}, {lx, _Real}, {ly, _Real}, {lz, _Real}},
	 (cang = (jx*lx + jy*ly + jz*lz)/Sqrt[jx^2+jy^2+jz^2]/Sqrt[lx^2+ly^2+lz^2];
	 If[Random[] > Sqrt[0.7094242-0.28198893*cang-0.19948687*cang^2-0.20807370*cang^3], 1, 0]
	 )];
fillhisto[m_, e_] := histo[[Floor[(m - 30)/2]+1, Floor[(e - 70)/2]+1]]++;
smear[1] = 2589;
smear[2] = 783;
smear[3] = 1434;
smear[4] = 1194;
smear[5] = 942;
smear[6] = 909;
smear[7] = 768;
smear[8] = 687;
smear[9] = 681;
smear[10] = 660;
smear[11] = 501;
smear[12] = 483;
smear[13] = 468;
smear[14] = 441;
smear[15] = 432;
smear[16] = 399;
smear[17] = 342;
smear[18] = 360;
smear[19] = 327;
smear[20] = 252;
smear[21] = 282;
smear[22] = 255;
smear[23] = 207;
smear[24] = 273;
smear[25] = 228;
smear[26] = 165;
smear[27] = 213;
smear[28] = 171;
smear[29] = 159;
smear[30] = 207;
smear[31] = 147;
smear[32] = 153;
smear[33] = 144;
smear[34] = 123;
smear[35] = 123;
smear[36] = 114;
smear[37] = 111;
smear[38] = 93;
smear[39] = 93;
smear[40] = 123;
smear[41] = 102;
smear[42] = 96;
smear[43] = 102;
smear[44] = 63;
smear[45] = 93;
smear[46] = 108;
smear[47] = 78;
smear[48] = 63;
smear[49] = 75;
smear[50] = 72;
smear[51] = 66;
smear[52] = 78;
smear[53] = 72;
smear[54] = 72;
smear[55] = 75;
smear[56] = 66;
smear[57] = 66;
smear[58] = 66;
smear[59] = 63;
smear[60] = 72;
smear[61] = 57;
smear[62] = 75;
smear[63] = 45;
smear[64] = 69;
smear[65] = 39;
smear[66] = 45;
smear[67] = 48;
smear[68] = 60;
smear[69] = 48;
smear[70] = 39;
smear[71] = 42;
smear[72] = 42;
smear[73] = 60;
smear[74] = 51;
smear[75] = 36;
smear[76] = 42;
smear[77] = 39;
smear[78] = 33;
smear[79] = 42;
smear[80] = 51;
smear[81] = 33;
smear[82] = 60;
smear[83] = 48;
smear[84] = 45;
smear[85] = 54;
smear[86] = 60;
smear[87] = 48;
smear[88] = 51;
smear[89] = 36;
smear[90] = 36;
smear[91] = 48;
smear[92] = 48;
smear[93] = 51;
smear[94] = 36;
smear[95] = 33;
smear[96] = 33;
smear[97] = 33;
smear[98] = 21;
smear[99] = 48;
smear[100] = 24;
smear[101] = 15;
smear[102] = 27;
smear[103] = 27;
smear[104] = 42;
smear[105] = 30;
smear[106] = 30;
smear[107] = 39;
smear[108] = 30;
smear[109] = 18;
smear[110] = 30;
smear[111] = 39;
smear[112] = 33;
smear[113] = 42;
smear[114] = 48;
smear[115] = 51;
smear[116] = 24;
smear[117] = 12;
smear[118] = 24;
smear[119] = 15;
smear[120] = 27;
smear[121] = 18;
smear[122] = 39;
smear[123] = 30;
smear[124] = 12;
smear[125] = 12;
smear[126] = 21;
smear[127] = 15;
smear[128] = 12;
smear[129] = 33;
smear[130] = 9;
smear[131] = 24;
smear[132] = 30;
smear[133] = 24;
smear[134] = 21;
smear[135] = 18;
smear[136] = 9;
smear[137] = 27;
smear[138] = 27;
smear[139] = 12;
smear[140] = 36;
smear[141] = 15;
smear[142] = 21;
smear[143] = 21;
smear[144] = 45;
smear[145] = 21;
smear[146] = 30;
smear[147] = 30;
smear[148] = 18;
smear[149] = 27;
smear[150] = 15;
smear[151] = 21;
smear[152] = 15;
smear[153] = 18;
smear[154] = 24;
smear[155] = 12;
smear[156] = 30;
smear[157] = 24;
smear[158] = 12;
smear[159] = 15;
smear[160] = 21;
smear[161] = 15;
smear[162] = 21;
smear[163] = 27;
smear[164] = 15;
smear[165] = 12;
smear[166] = 33;
smear[167] = 15;
smear[168] = 3;
smear[169] = 18;
smear[170] = 12;
smear[171] = 24;
smear[172] = 39;
smear[173] = 24;
smear[174] = 12;
smear[175] = 15;
smear[176] = 15;
smear[177] = 9;
smear[178] = 9;
smear[179] = 12;
smear[180] = 12;
smear[181] = 18;
smear[182] = 9;
smear[183] = 12;
smear[184] = 21;
smear[185] = 21;
smear[186] = 12;
smear[187] = 9;
smear[188] = 12;
smear[189] = 12;
smear[190] = 3;
smear[191] = 21;
smear[192] = 21;
smear[193] = 21;
smear[194] = 21;
smear[195] = 18;
smear[196] = 21;
smear[197] = 9;
smear[198] = 12;
smear[199] = 12;
smear[200] = 3;
smear[201] = 24;
smear[202] = 15;
smear[203] = 18;
smear[204] = 21;
smear[205] = 3;
smear[206] = 6;
smear[207] = 24;
smear[208] = 6;
smear[209] = 15;
smear[210] = 24;
smear[211] = 3;
smear[212] = 24;
smear[213] = 21;
smear[214] = 15;
smear[215] = 6;
smear[216] = 12;
smear[217] = 6;
smear[218] = 3;
smear[219] = 9;
smear[220] = 3;
smear[221] = 24;
smear[222] = 9;
smear[223] = 6;
smear[224] = 3;
smear[225] = 9;
smear[226] = 21;
smear[227] = 21;
smear[228] = 15;
smear[229] = 9;
smear[230] = 24;
smear[231] = 6;
smear[232] = 6;
smear[233] = 3;
smear[234] = 3;
smear[235] = 15;
smear[236] = 9;
smear[237] = 12;
smear[238] = 15;
smear[239] = 15;
smear[240] = 6;
smear[241] = 15;
smear[242] = 9;
smear[243] = 12;
smear[244] = 3;
smear[245] = 9;
smear[246] = 0;
smear[247] = 21;
smear[248] = 6;
smear[249] = 15;
smear[250] = 9;
smear[251] = 12;
smear[252] = 12;
smear[253] = 0;
smear[254] = 3;
smear[255] = 3;
smear[256] = 6;
smear[257] = 6;
smear[258] = 12;
smear[259] = 15;
smear[260] = 6;
smear[261] = 0;
smear[262] = 9;
smear[263] = 6;
smear[264] = 15;
smear[265] = 18;
smear[266] = 3;
smear[267] = 9;
smear[268] = 3;
smear[269] = 12;
smear[270] = 0;
smear[271] = 12;
smear[272] = 6;
smear[273] = 3;
smear[274] = 3;
smear[275] = 3;
smear[276] = 9;
smear[277] = 15;
smear[278] = 6;
smear[279] = 0;
smear[280] = 9;
smear[281] = 0;
smear[282] = 3;
smear[283] = 0;
smear[284] = 0;
smear[285] = 15;
smear[286] = 6;
smear[287] = 0;
smear[288] = 6;
smear[289] = 12;
smear[290] = 6;
smear[291] = 6;
smear[292] = 15;
smear[293] = 9;
smear[294] = 15;
smear[295] = 21;
smear[296] = 12;
smear[297] = 3;
smear[298] = 18;
smear[299] = 0;
smear[300] = 1662;
dosmear = Compile[{},
		  (If[Random[] < 0.099184, 1,
		      If[Random[] < 0.0706813, 300,
			 If[Random[] < 0.745881,
			    (x = Random[Integer, {2, 50}];
			     y = Random[Integer, 1434];
			     While[y > smear[x],
				   (x = Random[Integer, {2, 50}];
				    y = Random[Integer, 1434];)];
			     x),
			    (x = Random[Integer, {51, 300}];
			     y = Random[Integer, 1662];
			     While[y > smear[x],
				   (x = Random[Integer, {51, 299}];
				    y = Random[Integer, 78];)];
			     x)]]] - 1)/10];
randomevent =
    Compile[{zeta, chmass, lspmass, top},
	    (failed = False;
	     vphoz = {500, 0, 0, 0};
	     ch1p = randomtwobody[vphoz, chmass, chmass];
	     ch1m = vphoz - ch1p;
	     wpmass = randomandreas[zeta, chmass, lspmass, top];
	     mrecon = wpmass - dosmear[];
	     If[mrecon < 30  ||  mrecon > 60, failed = True];
	     If[!failed, (wp = randomtwobody[ch1p, wpmass, lspmass];
			  erecon = wp[[1]];
			  If[erecon < 70  ||  erecon > 140, failed = True])];
	     If[!failed, (j1 = randomtwobody[wp, 0, 0];
			  If[Abs[j1[[4]]]/Sqrt[j1[[2]]^2+j1[[3]]^2+j1[[4]]^2] > 0.95, failed = True])];
	     If[!failed, (
		 j2 = wp - j1;
		 If[Abs[j2[[4]]]/Sqrt[j2[[2]]^2+j2[[3]]^2+j2[[4]]^2] > 0.95, failed = True]
			 )];
	     If[!failed, (
		 wmmass = randomandreas[zeta, chmass, lspmass, top];
		 wm = randomtwobody[ch1m, wmmass, lspmass];
		 ell = randomtwobody[wm, 0, 0];
		 If[Abs[ell[[4]]]/Sqrt[ell[[2]]^2+ell[[3]]^2+ell[[4]]^2] > 0.95, failed = True]
			 )];
	     If[!failed, (
		 jsum = j1 + j2;
		 If[Sqrt[jsum[[2]]^2+jsum[[3]]^2] < 25, failed = True]
			 )];
	     If[!failed, If[jetconfused[j1[[2]], j1[[3]], j1[[4]], ell[[2]], ell[[3]], ell[[4]]] == 1, failed = True]];
	     If[!failed, If[jetconfused[j2[[2]], j2[[3]], j2[[4]], ell[[2]], ell[[3]], ell[[4]]] == 1, failed = True]];
	     If[!failed, fillhisto[mrecon, erecon]];
	     If[!failed, 1, 0]
	    )];
chisquare = 
    Compile[{{zeta, _Real}, {mc, _Real}, {mlsp, _Real}},
	    histo = Table[0, {15}, {35}];
	    thetop = topofandreas[zeta, mc, mlsp];
	    mcsum = Plus @@ Table[randomevent[zeta, mc, mlsp, thetop], {Floor[183300]}];
	    histn[zeta, mc, mlsp] = datasum/mcsum*histo;
	    Sum[If[data[[i,j,2]] > 0,
		    (data[[i,j,1]] - datasum/mcsum*histo[[i,j]])^2/data[[i,j,2]]^2, 0],
		 {i, 1, 15}, {j, 1, 35}],
	   {{data, _Real, 3}, {histo, _Real, 2}}];

bowl = Flatten[Table[{zeta, mc, mlsp, chisquare[zeta, mc, mlsp]},
		     {zeta, 0.8, 1, 0.05},
		     {mc, 159.417 - 4, 159.417 + 4, 2},
		     {mlsp, 107.697 - 4, 107.697 + 4, 2}], 2];
fitbowl = Fit[bowl, {1, zeta, zeta^2, mc, mc^2, mlsp, mlsp^2, zeta*mc, zeta*mlsp, mc*mlsp}, {zeta, mc, mlsp}]

[Mathematica aborted this and the next calculation.]

DumpSave["fakeit1.mx", {bowl, histn, fitbowl}];

Out[4]= $Aborted



FindMinimum[fitbowl, {{zeta, 0.9}, {mc, 159.417}, {mlsp, 107.697}}]


DensityPlot[Interpolation[{#[[2]], #[[3]], #[[4]]}& /@ Select[bowl, (#[[1]] == 0.9)&]][mc, mlsp], {mc, 159.417 - 4, 159.417 + 4}, {mlsp, 107.697 - 4, 107.697 + 4},
	    Frame -> True,
	    FrameLabel -> {"Mass of chargino (GeV)", "Mass of LSP (GeV)", "Chi-squared of fit with zeta = 0.9 (doesn't matter +- 0.1)", None},
	    ImageSize -> 72*6
(* 	    , DisplayFunction -> (Display["fakeit_chisquare.eps", #, "EPS"]&) *)
	   ];


histo = histn[0.9, 159.417, 107.697];
MultipleListPlot[
    {Table[{{(i-1)*2+30, Sum[data[[i,j,1]], {j, 1, 35}]}, ErrorBar[Sqrt[Sum[data[[i,j,2]]^2, {j, 1, 35}]]]}, {i, 1, 15}],
     Table[{(i-1)*2+30, Sum[histo[[i,j]], {j, 1, 35}]}, {i, 1, 15}]},
    SymbolStyle -> {RGBColor[1,0,0], RGBColor[0,0,1]},
    Frame -> True,
    Axes -> True,
    AxesOrigin -> {29, 0},
    PlotRange -> {{29, 61}, {-40, 1000}},
    FrameLabel -> {"Jet-jet invariant mass (GeV)", None, "zeta=0.9, mLSP, mChar", None},
    ImageSize -> 72*6
(*    , DisplayFunction -> (Display["fakeit_mass.eps", #, "EPS"]&) *)
		];

MultipleListPlot[
    {Table[{{(j-1)*2+70, Sum[data[[i,j,1]], {i, 1, 15}]}, ErrorBar[Sqrt[Sum[data[[i,j,2]]^2, {i, 1, 15}]]]}, {j, 1, 35}],
     Table[{{(j-1)*2+70, datasum/mcsum*Sum[histo[[i,j]], {i, 1, 15}]}, ErrorBar[datasum/mcsum*Sqrt[Sum[histo[[i,j]], {i, 1, 15}]]]}, {j, 1, 35}]},
    SymbolStyle -> {RGBColor[1,0,0], RGBColor[0,0,1]},
    SymbolStyle -> {RGBColor[1,0,0], RGBColor[0,0,1]},
    Frame -> True,
    Axes -> True,
    AxesOrigin -> {69, 0},
    PlotRange -> {{69, 141}, {-20, 500}},
    FrameLabel -> {"Two-jet total energy (GeV)", None, "zeta=0.9, mLSP, mChar", None},
    ImageSize -> 72*6
(*    , DisplayFunction -> (Display["fakeit_energy.eps", #, "EPS"]&) *)
		];


